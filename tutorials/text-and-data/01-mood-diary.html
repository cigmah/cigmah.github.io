<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-08-03 Sat 23:29 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mood Diary</title>
<meta name="generator" content="Org mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="main.css" rel="stylesheet">
<link href="../main.css" rel="stylesheet">
<link href="../../main.css" rel="stylesheet">
<link rel="shortcut icon" href="./favicon.ico">
<link rel="shortcut icon" href="../favicon.ico">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
<h1 class="title">Mood Diary</h1>
</div>
<div id="content">
<input type="checkbox" id="sitemap-toggle" role="button" data-target="sitemap"/>
<label id="sitemap-label" for="sitemap-toggle">map</label>
<nav id="sitemap">
<ul class="org-ul">
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-05-29 Wed]    </span></span>    <a href="../../index.html">CIGMAH</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-02-20 Wed]    </span></span>    <a href="../../resources.html">Resources</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-02-20 Wed]    </span></span>    <a href="../../about.html">About</a></li>
<li>Tutorials/
<ul class="org-ul">
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-08-02 Fri]    </span></span>    <a href="../intro.html">Introduction</a></li>
<li>Tutorials/Text-And-Data/
<ul class="org-ul">
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-08-03 Sat]    </span></span>    <a href="02-contraindicated.html">Contraindicated</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-08-03 Sat]    </span></span>    <a href="01-mood-diary.html">Mood Diary</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-08-02 Fri]    </span></span>    <a href="04-mapping-meningitis.html">Mapping Meningitis</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-08-02 Fri]    </span></span>    <a href="03-transfusion-tracing.html">Transfusion Tracing</a></li>
</ul></li>
</ul></li>
<li>Features/
<ul class="org-ul">
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-07-29 Mon]    </span></span>    <a href="../../features/chris-wright.html">Prof Chris Wright</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-04-18 Thu]    </span></span>    <a href="../../features/kevin-shi.html">Participant Feature: Kevin Shi</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-04-15 Mon]    </span></span>    <a href="../../features/chris-bain.html">Prof Chris Bain</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-04-12 Fri]    </span></span>    <a href="../../features/yingtong-li.html">Participant Feature: Yingtong Li</a></li>
</ul></li>
<li>Misc/
<ul class="org-ul">
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-08-02 Fri]    </span></span>    <a href="../../misc/puzzle-index.html">Topics and Puzzle Index</a></li>
</ul></li>
<li>Games/
<ul class="org-ul">
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-07-13 Sat]    </span></span>    <a href="../../games/worst-offender.html">Worst Offender</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-07-13 Sat]    </span></span>    <a href="../../games/what-dipstick.html">What Dipstick?</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-07-13 Sat]    </span></span>    <a href="../../games/sti-bugs-n-drugs.html">STI Bugs 'n' Drugs</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-07-13 Sat]    </span></span>    <a href="../../games/base-in-balance.html">Base in Balance</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-06-07 Fri]    </span></span>    <a href="../../games/neurologic.html">NeuroLogic</a></li>
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-05-25 Sat]    </span></span>    <a href="../../games/tarsal-tumble.html">Tarsal Tumble</a></li>
</ul></li>
<li>Aorta/
<ul class="org-ul">
<li><span class="timestamp-wrapper"><span class="timestamp">[2019-07-14 Sun]    </span></span>    <a href="../../aorta/help_wanted.html">AORTA - FAQ and Help Wanted</a></li>
</ul></li>
</ul>
</nav>

<div id="outline-container-org46dd56a" class="outline-2">
<h2 id="org46dd56a">Problem</h2>
<div class="outline-text-2" id="text-org46dd56a">
<p>
Kennedy, a 26 year old male, has been struggling with depression. On your
advice, he has started tracking and reflecting on his mood every day for the
past two years from 1st January 2020 to 31st December 2021 inclusive.
</p>

<p>
To track his mood, he used a (fictional) mobile app - Mood Diary. Every day,
Mood Diary would send him a push notification asking him to select one of five
moods. Each mood corresponds to one of five mood levels, and is drawn randomly
from a descriptor pool for that level. Here are the descriptors Mood Diary uses:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Mood Level</th>
<th scope="col" class="org-left">Descriptors</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">Depressed, very low, hopeless, bleak</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">Low, sad, teary, flat, tired, stressed</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">So-so, okay, fine, not bad, satisfied</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">Good, refreshed, happy, joyful</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">On top of the world, ecstatic, elated, elevated, amazing, brilliant, fantastic</td>
</tr>
</tbody>
</table>

<p>
For example, on a given day, Mood Diary might present the five words
"Depressed", "Tired", "Fine", "Refreshed" and "Amazing". Kennedy then selects
one of those five moods for that day.
</p>

<p>
Kennedy has exported his mood results and would like you to help him interpret
them. The exported data consists of one line per day - a date, four spaces, then
a sentence which Mood Diary uses to represent each day ("I feel {MOOD} today.").
</p>

<div class="org-src-container">
<pre class="src src-text">2020/01/01    I feel TEARY today.
</pre>
</div>

<p>
<b>Your task</b> is to:
</p>

<ol class="org-ol">
<li>Process Kennedy's exported Mood Diary text and classify each day into a mood
level.</li>
<li>Plot Kennedy's mood level over the 2 years.</li>
<li>Identify approximately when (to the nearest month) Kennedy's mood level took
a turn for the better during the two years, after which Kennedy's mood was
consistently better than before.</li>
</ol>

<p>
<a href="./input-mood-diary.txt">Click here to download your text input. (26KB, .txt).</a>
</p>
</div>
</div>

<div id="outline-container-orgeb1542b" class="outline-2">
<h2 id="orgeb1542b">Solution</h2>
<div class="outline-text-2" id="text-orgeb1542b">
</div>
<div id="outline-container-orgf9f6928" class="outline-3">
<h3 id="orgf9f6928">Data Generation</h3>
<div class="outline-text-3" id="text-orgf9f6928">
<blockquote>
<p>
This data was generated with the <a href="https://www.jsoftware.com/#/">J programming language</a>. J is a descendent of
the <a href="https://en.wikipedia.org/wiki/APL_(programming_language)">APL programming language family</a>, infamous for being terse and apparently
unreadable. APL and J make very heavy use of symbols to expose useful primitive
operations on arrays - similar in many ways to Matlab or Python's Numpy. Though
the symbolism may look like obfuscation, it's not intentional. One of the core
ideas of the APL family is about operating on collections of data as a whole
rather than using conditional or looping structures, and the notation is simply
a way to express these operations compactly.
</p>

<p>
If you are interested in the APL/J/K family of languages, then we are always
very happy to have a chat to explain more about them. K (similar to J) is
apparently used quite heavily in the financial industry - so even though the
languages may appear unreadable, they <i>are</i> used in real-life.
</p>
</blockquote>

<p>
First, we define the qualitative words and their groupings into mood levels.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">Level1</span> <span style="color: #000000;">=:</span> <span style="color: #50a14f;">'DEPRESSED'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'VERY LOW'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'HOPELESS'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'BLEAK'</span>
<span style="color: #6a1868;">Level2</span> <span style="color: #000000;">=:</span> <span style="color: #50a14f;">'LOW'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'SAD'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'TEARY'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'FLAT'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'TIRED'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'STRESSED'</span>
<span style="color: #6a1868;">Level3</span> <span style="color: #000000;">=:</span> <span style="color: #50a14f;">'SO-SO'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'OKAY'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'FINE'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'NOT BAD'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'SATISFIED'</span>
<span style="color: #6a1868;">Level4</span> <span style="color: #000000;">=:</span> <span style="color: #50a14f;">'GOOD'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'REFRESHED'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'HAPPY'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'JOYFUL'</span>
<span style="color: #6a1868;">Level5</span> <span style="color: #000000;">=:</span> <span style="color: #50a14f;">'ON TOP OF THE WORLD'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'ECSTATIC'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'ELATED'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'ELEVATED'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'AMAZING'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'BRILLIANT'</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'FANTASTIC'</span>
<span style="color: #6a1868;">Levels</span> <span style="color: #000000;">=:</span> Level1<span style="color: #ff0000;">;</span>Level2<span style="color: #ff0000;">;</span>Level3<span style="color: #ff0000;">;</span>Level4<span style="color: #ff0000;">;&lt;</span>Level5
</pre>
</div>

<p>
Next, we define important dates for the data.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">StartDate</span> <span style="color: #000000;">=:</span> 2020 1 1
<span style="color: #6a1868;">EndDate</span> <span style="color: #000000;">=:</span> 2022 1 1
<span style="color: #6a1868;">ChangeDate</span> <span style="color: #000000;">=:</span> 2021 4 3
</pre>
</div>

<p>
We will model the mood with a low-amplitude sine wave with random perturbations, then
round it to one of the five levels. We'll give the sine function a period of 4
weeks and an amplitude of 1.5, and translate it so that it averages around
Level2 (or index 1 of the <code>Levels</code> array). We'll also add some random noise as a
uniform distribution between -1 and 1, and make sure to keep it between 0 and 4.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">mood1</span> <span style="color: #000000;">=:</span> dyad <span style="color: #ff0000;">:</span><span style="color: #50a14f;">'&lt;.0&gt;.(1-~2*x)+1+1.5*1&amp;o.28%~o.y'</span>
</pre>
</div>

<p>
After <code>ChangeDate</code>, we'll translate the the mood so it averages around Level 3
(index 2), with an amplitude of 0.8 and lower random noise.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">mood2</span> <span style="color: #000000;">=:</span> dyad <span style="color: #ff0000;">:</span><span style="color: #50a14f;">'&lt;.5&lt;.0&gt;.(0.5-~x)+2+0.8*1&amp;o.28%~o.y'</span>
</pre>
</div>

<p>
We'll now create the numerical data.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">NumData1</span> <span style="color: #000000;">=:</span> (<span style="color: #ff0000;">?</span><span style="color: #0000ff;">@:</span><span style="color: #ff0000;">#</span><span style="color: #0000ff;">&amp;</span>0 mood1 <span style="color: #ff0000;">i.</span>) ChangeDate(todayno<span style="color: #0000ff;">@</span><span style="color: #ff0000;">[-</span>todayno<span style="color: #0000ff;">@</span><span style="color: #ff0000;">]</span>)StartDate
<span style="color: #6a1868;">NumData2</span> <span style="color: #000000;">=:</span> (<span style="color: #ff0000;">?</span><span style="color: #0000ff;">@:</span><span style="color: #ff0000;">#</span><span style="color: #0000ff;">&amp;</span>0 mood2 <span style="color: #ff0000;">i.</span>) EndDate(todayno<span style="color: #0000ff;">@</span><span style="color: #ff0000;">[-</span>todayno<span style="color: #0000ff;">@</span><span style="color: #ff0000;">]</span>)ChangeDate
<span style="color: #6a1868;">NumData</span> <span style="color: #000000;">=:</span> NumData1<span style="color: #ff0000;">,</span>NumData2
</pre>
</div>

<p>
Next, we define a function to index into levels using <code>NumData</code> and choose a
random word at the corresponding level.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">pick</span> <span style="color: #000000;">=:</span> <span style="color: #ff0000;">[:</span>(<span style="color: #ff0000;">?</span><span style="color: #0000ff;">@</span><span style="color: #ff0000;">#{]</span>)<span style="color: #ff0000;">&gt;</span><span style="color: #0000ff;">@:</span><span style="color: #ff0000;">{</span><span style="color: #0000ff;">&amp;</span>Levels
</pre>
</div>

<p>
We can then convert the numerical data into boxed descriptors.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">WordData</span> <span style="color: #000000;">=:</span> <span style="color: #ff0000;">;</span> pick each NumData
</pre>
</div>

<p>
And convert the dates to corresponding strings.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">Days</span> <span style="color: #000000;">=:</span> (todayno StartDate)<span style="color: #0000ff;">&amp;</span><span style="color: #ff0000;">+</span> <span style="color: #ff0000;">i.</span> EndDate(todayno<span style="color: #0000ff;">@</span><span style="color: #ff0000;">[-</span>todayno<span style="color: #0000ff;">@</span><span style="color: #ff0000;">]</span>)StartDate
<span style="color: #6a1868;">pad</span> <span style="color: #000000;">=:</span> 4 2 2<span style="color: #0000ff;">&amp;</span>(((<span style="color: #ff0000;">[</span><span style="color: #0000ff;">@</span>(<span style="color: #50a14f;">'0'</span><span style="color: #ff0000;">#</span><span style="color: #00ff00;">~</span><span style="color: #ff0000;">[-#</span><span style="color: #0000ff;">@</span><span style="color: #ff0000;">]</span>)<span style="color: #ff0000;">,]</span>) <span style="color: #ff0000;">":</span><span style="color: #0000ff;">@</span><span style="color: #ff0000;">]</span>) each)
<span style="color: #6a1868;">Dates</span> <span style="color: #000000;">=:</span> (pad<span style="color: #0000ff;">@</span>todate) each Days
</pre>
</div>

<p>
Finally, we define a function to format the data.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">fmtword</span> <span style="color: #000000;">=:</span> (<span style="color: #50a14f;">'I feel '</span><span style="color: #ff0000;">,</span>LF<span style="color: #ff0000;">,</span><span style="color: #00ff00;">~</span><span style="color: #50a14f;">' today.'</span><span style="color: #ff0000;">,</span><span style="color: #00ff00;">~</span><span style="color: #ff0000;">]</span>)
<span style="color: #6a1868;">fmtdate</span> <span style="color: #000000;">=:</span> 1<span style="color: #ff0000;">}.</span><span style="color: #0000ff;">&amp;:</span><span style="color: #ff0000;">;</span><span style="color: #50a14f;">'/'</span><span style="color: #ff0000;">,</span>each<span style="color: #ff0000;">]</span>
<span style="color: #6a1868;">fmt</span> <span style="color: #000000;">=:</span> dyad <span style="color: #ff0000;">:</span><span style="color: #50a14f;">'(fmtdate x),''    '',(fmtword y)'</span>
</pre>
</div>

<p>
We then format the data and save it.
</p>

<div class="org-src-container">
<pre class="src src-j"><span style="color: #6a1868;">DataString</span> <span style="color: #000000;">=:</span> <span style="color: #ff0000;">;</span> Dates fmt each WordData
DataString fwrite <span style="color: #ff0000;">&lt;</span> <span style="color: #50a14f;">'input-mood-diary.txt'</span>
</pre>
</div>
</div>
</div>
</div>
</div>
</body>
</html>
