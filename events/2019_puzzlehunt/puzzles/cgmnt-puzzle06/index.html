
<!DOCTYPE html>
<html><head>
    
    
    <title> CIGMAH - While You&#39;re Waiting </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="2019 Puzzle Hunt - Puzzle 06B">
    <meta name="theme-color" content="#000000" />
    <link rel="icon" href="https://cigmah.org/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cigmah.org/js/toggles.js"></script>
    <link type="text/css" rel="stylesheet" href=https://cigmah.org/sass/main.css>
    <link rel="canonical" href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle06/">
</head>
<body>
        <header>

            <nav id="nav-menu-toggle" onClick="toggleNav()">
                <div id="menu-text">☰</div>
                <div id="cigmah-brand">
                    <div id="cigmah-icon">
                        <img src="https://cigmah.org/img/cigmah-icon.png">
                    </div>
                    <div id="cigmah-text">
                        CIGMAH
                    </div>
                </div>
            </nav>

            <nav id="nav-bar">

<ul id="nav-link-list" onClick="()">

    <li
        class="nav-link-list-item "
    >
        <a
            class="nav-link-list-link "
            id="nav-cigmah-link"
            href=https://cigmah.org/
        >
            <img id="nav-cigmah-link-icon" src="/img/cigmah-icon-small.png">
            <div>CIGMAH</div>
        </a>
    </li>

  
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/about/
        >
            About
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/events/
        >
            Events
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/tools/
        >
            Tools
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/resources/
        >
            Resources
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/blog/
        >
            Blog
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/contact/
        >
            Contact
        </a>
    </li>
    

    <li
        class="nav-link-list-item"
        id="nav-right-item"
        >
        <a
            href="https://apps.cigmah.org"
            id="nav-aorta-link"
            class="nav-link-list-link"
        >
            <div id="nav-aorta-link">Web Apps</div>
        </a>
    </li>
</ul>
</nav>

        </header>

        <main>



<section class="normal-page">
    <article id="side-navigation">
        <article id="toggle-side-navigation-container">

            
            <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle05/" id="back"> &lt;&lt; </a>
            

            <button id="toggle-side-navigation" onClick="toggleSideNav()">Show Articles</button>

            
            <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle07/" id="next"> &gt;&gt; </a>
            

        </article>

        <ul id="side-navigation-list">

            
            <li class="side-navigation-parent">
                <a href="https://cigmah.org/events/">Events</a>
            </li>
            


            <li class="side-navigation-section">
                <a href="https://cigmah.org/events/2019_puzzlehunt/">
                    2019 Puzzle Hunt
                </a>
            </li>

            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle01/">Lost in a Library</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle02/">Metabolic Mayhem</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle03/">Combo Catcher</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle04/">Troubled Test</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle05/">Out of Sync</a>
            </li>
            
            <li
                class="side-navigation-item  active "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle06/">While You&#39;re Waiting</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle07/">Infectious Network</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle08/">Tarsal Tumble</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle09/">Fundal Flow</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle10/">Bite Cell Scouting</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle11/">NeuroLogic</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle12/">Reschedule All</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle13/">Allele Inference</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle14/">Base in Balance</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle15/">Worst Offender</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle16/">STI Bugs&#39;n&#39;Drugs</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle17/">What Dipstick?</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle18/">Peak Flow Diary</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle19/">HPV Profiling</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle20/">Code Broadcast</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle21/">Genetic Thrift</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle22/">Neural Decoding</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle23/">Run! (Preclinical)</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle24/">Run! (Clinical)</a>
            </li>
            

        </ul>

    </article>

    <section id="container">

        <article id="content">
            <header id="content-header">
            <h1 id="content-title"> While You&#39;re Waiting </h1>

            
                <div id="subtitle">
                    <div> 2019 Puzzle Hunt - Puzzle 06B </div>
                </div>
            

            </div>

            </header>

            <section id="content-body">
                <blockquote>
<p>This puzzle was released on 2019-03-09, and was the Beginner puzzle for the theme <em>Automatic, Automata</em>.</p>
</blockquote>
<p>It&rsquo;s 1:20am. Facing North, you walk through the corridor on the 4th wall.</p>
<p><img src="https://i.imgur.com/Q5Sxr2x.gif" alt="Image"></p>
<p>You open the book on the table. It&rsquo;s called <em>Rhinal RPG</em>, a combination of words you&rsquo;d never thought you&rsquo;d hear in your lifetime&hellip;and never really wanted to hear.</p>
<p>You start reading.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">┌────────────────────────────────────────────┐
│ Hi, I&#39;m Dr Lionel. I&#39;m the head Rhino at   │
│ Rhinal Clinics! Bahaha!                  ▾ │
└────────────────────────────────────────────┘
┌────────────────────────────────────────────┐
│ You know our clinics? Our clinic is        │
│ different from regular clinics. It&#39;s like  │
│ my clinic is in the top percentage of all  │
│ rhinitis clinics! Bahaha!                ▾ │
└────────────────────────────────────────────┘
┌────────────────────────────────────────────┐
│ You look like a sharp one. How about doing │
│ a little job for me? We have a lot of      │
│ patients. Of course we do! Why wouldn&#39;t    │
│ we? We&#39;re a popular clinic!              ▾ │
└────────────────────────────────────────────┘
┌────────────────────────────────────────────┐
│ But patients don&#39;t like waiting. No one    │
│ likes waiting! I don&#39;t like waiting! But   │
│ you know what I do like? Not waiting!      │
│ Bahaha!                                  ▾ │
└────────────────────────────────────────────┘
┌────────────────────────────────────────────┐
│ Instead of waiting, patients fill out a    │
│ form about their allergic rhinitis. I like │
│ forms! They&#39;re lovely and easy to share! ▾ │
└────────────────────────────────────────────┘
┌────────────────────────────────────────────┐
│ But I want the forms to help me. I want    │
│ everyone to help me. I want you to help    │
│ me! I want the forms to classify someone&#39;s │
│ rhinitis for me. Then I don&#39;t have to do   │
│ it!                                      ▾ │
└────────────────────────────────────────────┘
┌────────────────────────────────────────────┐
│ Enough talking! You&#39;ve talked too much. I  │
│ could be seeing patients right now! Here&#39;s │
│ the classification. Now go forth and       │
│ classify! That&#39;s my motto! Bahaha!       ▾ │
└────────────────────────────────────────────┘

</code></pre></div><p>(Who <em>wrote</em> this? A robot? You think you&rsquo;re going to vomit if you hear someone say &ldquo;bahaha&rdquo; just one more time&hellip;)</p>
<p>There&rsquo;s some more text and a table following [1]:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">
Allergic rhinitis symptoms are classified by DURATION AND SEVERITY.


DURATION:

+------------------------------------+------------------------------------+
|            Intermittent            |            Persistent              |
+------------------------------------+------------------------------------+
| EITHER of                          | BOTH of                            |
| 1. Symptoms &lt; 4 days per week, OR  | 1. Symptoms &gt;= 4 days per week     |
| 2. Symptoms &lt; 4 consecutive weeks. | 2. Symptoms &gt;= 4 consecutive weeks |
+------------------------------------+------------------------------------+

SEVERITY:

+---------------------------------+---------------------------------------------------------+
|              Mild               |                   Moderate to Severe                    |
+---------------------------------+---------------------------------------------------------+
| NONE of the stuff on the right. | ANY (one or more) of:                                   |
|                                 | 1. Troublesome symptoms                                 |
|                                 | 2. Sleep disturbance                                    |
|                                 | 3. Impairment of daily activities, leisure and/or sport |
|                                 | 4. Impairment of school or work performance             |
+---------------------------------+---------------------------------------------------------+

Thus, allergic rhinitis can be classified into four groups:

1. Mild intermittent
2. Mild persistent
3. Moderate-to-severe intermittent
4. Moderate-to-severe persistent

</code></pre></div><p>You think you understand the problem - Dr Rhinal&rsquo;s given you a list of form data submitted by patients and wants you to figure out what classification of allergic rhinitis each patient would fall into. You could see the utility for this - after all, the classification is very specific and Dr Rhinal could spend less time classifying, and more time managing.</p>
<h1 id="input">Input</h1>
<p><a href="https://drive.google.com/open?id=1WfX4jj8XYS0rqM_9hr_idXHqFU49kcSd">cgmnt_input06.csv</a> (165KB)</p>
<p>Templates on <a href="https://mybinder.org/v2/gh/cigmah/cgmnt-beginners/master">Binder</a>, <a href="https://notebooks.azure.com/cigmah-cgmnt/projects/cgmnt">Azure Notebooks</a> and <a href="https://github.com/cigmah/cgmnt-beginners/">GitHub</a>.</p>
<h1 id="statement">Statement</h1>
<p>State the number of patients in Dr Rhinal&rsquo;s list with <strong>moderate-to-severe persistent</strong> allergic rhinitis.</p>
<h1 id="references">References</h1>
<p>Written by the CIGMAH Puzzle Hunt Team.</p>
<p>[1] This reference table for classification of allergic rhinitis is from the <a href="https://www.asthmahandbook.org.au/table/show/54">Australian Asthma Handbook</a>.</p>
<hr>
<h1 id="answer">Answer</h1>
<p>The correct solution was <code>1758</code>.</p>
<h1 id="explanation">Explanation</h1>
<h2 id="map-hint">Map Hint</h2>
<p>Great work! It&rsquo;s been a long time since you last played an RPG, but you have to wonder what <em>Rhinal RPG</em> would have been like&hellip;</p>
<p>You open <code>map_hint.txt</code>. It contains only two words:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">shifting caesar
</code></pre></div><p>Hm&hellip;&ldquo;caesar&rdquo;? That reminds you, you haven&rsquo;t eaten for a while. Better find a way out of this library soon&hellip;</p>
<h2 id="writers-notes">Writer&rsquo;s Notes</h2>
<h3 id="objectives">Objectives</h3>
<ol>
<li>Practise basic CSV reading and processing using Pandas.</li>
<li>Practise implementing a simple classification system.</li>
</ol>
<h3 id="context">Context</h3>
<p>There are some tasks in medicine which are readily amenable to automation - some classifications and interpretive algorithms are simple and specific enough that automation could be used to free up some time to do other things. What&rsquo;s more, being able to describe these classifications and algorithms to a computer means that these can be replicated exactly and without much cost, which can improve both the reliability and accessibility of such tools.</p>
<p>Many algorithms in medicine, however, are primarily for &ldquo;guidance&rdquo; and it is often expected that senior clinicians will use these to supplement expert knowledge. This is especially true for treatment algorithms; many factors about a patient&rsquo;s individual situation can influence treatment decision-making and such treatments should always be in consultation with the patient themselves.</p>
<p>We chose a very simple, and very specific, classification for allergic rhinitis to help beginners have a go at using code in some way that integrates with medical learning and hopefully shows a very approachable case of where coding can help provide tools to assist medical care. We were very much aware that this puzzle could be completed in Excel (which most people will be familiar with to some extent). We hoped that an Excel-solvable problem could help make the coded solution more easily digestible by pointing out similarities and differences between Excel&rsquo;s capabilities and a Python implementation using Pandas.</p>
<h3 id="example-solution">Example Solution</h3>
<blockquote>
<p>Note: Our example solutions are just one way of approaching our puzzles. They&rsquo;re not necessarily the best way, or even a good way!</p>
</blockquote>
<p>Loading data:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">pd</span>

df <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_csv(<span style="color:#ba2121">&#34;https://drive.google.com/uc?id=1WfX4jj8XYS0rqM_9hr_idXHqFU49kcSd&#34;</span>)
</code></pre></div><p>Making a function to return <code>True</code> for a row if it is classified as moderate-to-severe persistent allergic rhinitis:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">is_mod_persistent</span>(row):
    <span style="color:#008000;font-weight:bold">if</span> (row<span style="color:#666">.</span>symptoms_days_per_week     <span style="color:#666">&gt;=</span> <span style="color:#666">4</span> <span style="color:#a2f;font-weight:bold">and</span>
        row<span style="color:#666">.</span>symptoms_consecutive_weeks <span style="color:#666">&gt;=</span> <span style="color:#666">4</span> <span style="color:#a2f;font-weight:bold">and</span>
        <span style="color:#008000">any</span>([row<span style="color:#666">.</span>troublesome_symptoms,
             row<span style="color:#666">.</span>disturbed_sleep,
             row<span style="color:#666">.</span>personal_activities_impaired,
             row<span style="color:#666">.</span>work_impaired])
       ):
            <span style="color:#008000;font-weight:bold">return</span> True
    <span style="color:#008000;font-weight:bold">return</span> False
</code></pre></div><p>Then applying it to the Data Frame and summing over rows where this returns <code>True</code>:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000">sum</span>(df<span style="color:#666">.</span>apply(is_mod_persistent, axis<span style="color:#666">=</span><span style="color:#666">1</span>))
</code></pre></div><pre><code>1758
</code></pre>
<h3 id="data-generation">Data Generation</h3>
<p>In order to classify allergic rhinitis according to the guidelines we&rsquo;ve referenced, we need the following information:</p>
<ol>
<li>How many days per week symptoms occur</li>
<li>How many consecutive weeks symptoms have occurred for</li>
<li>Whether symptoms are troublesome</li>
<li>Whether sleep is disturbed</li>
<li>Whether daily activities, leisure and/or sport are impaired (we&rsquo;ll call these &ldquo;personal activities&rdquo; for shorthand)</li>
<li>Whether school or work is impaired (we&rsquo;ll call these &ldquo;work activities&rdquo; for shorthand)</li>
</ol>
<p>So we&rsquo;ll generate a CSV file with 6 (plus an ID) columns and we&rsquo;ll arbitrarily choose 5000 rows so our answer is large enough to not be guessible.</p>
<p>We referenced a study with some rough proportions of each type in Korea [1]. We&rsquo;ll use these for now - we thought it would be a good idea to prevent the proportions being 25% for each classification as it might make guessing too easy!</p>
<p>We&rsquo;ll generate the data by specifically asking for a certain classification, and then generating the data for it.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">random</span>
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#ba2121">&#34;&#34;&#34; There are only six items we need - that&#39;s quite manageable. We&#39;ll make each patient simply a
</span><span style="color:#ba2121">    list of seven values - an ID, then the six values we specified above.
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">    1. ID
</span><span style="color:#ba2121">    2. Days per week
</span><span style="color:#ba2121">    3. Consecutive weeks
</span><span style="color:#ba2121">    4. Troublesome symptoms
</span><span style="color:#ba2121">    5. Disturbed sleep
</span><span style="color:#ba2121">    6. Personal impaired
</span><span style="color:#ba2121">    7. Work impaired
</span><span style="color:#ba2121">&#34;&#34;&#34;</span>

<span style="color:#008000;font-weight:bold">class</span> <span style="color:#00f;font-weight:bold">Patient</span>(<span style="color:#008000">object</span>):
    <span style="color:#ba2121">&#34;&#34;&#34;
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">    Args:
</span><span style="color:#ba2121">        intermittent (boolean) : Intermittent if True, else Persistent
</span><span style="color:#ba2121">        mild (boolean) : Mild if True, else Moderate-Severe
</span><span style="color:#ba2121">        patient_id (string): Patient ID
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">    Attributes:
</span><span style="color:#ba2121">        data: Generate data
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">    &#34;&#34;&#34;</span>

    <span style="color:#008000;font-weight:bold">def</span> __init__(self, patient_id, intermittent, mild):

        self<span style="color:#666">.</span>patient_id <span style="color:#666">=</span> patient_id
        self<span style="color:#666">.</span>intermittent <span style="color:#666">=</span> intermittent
        self<span style="color:#666">.</span>mild <span style="color:#666">=</span> mild
        self<span style="color:#666">.</span>data <span style="color:#666">=</span> self<span style="color:#666">.</span>generate_data()

    <span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">generate_data</span>(self):
        <span style="color:#008000;font-weight:bold">if</span> self<span style="color:#666">.</span>intermittent:
            choices <span style="color:#666">=</span> [random<span style="color:#666">.</span>randint(<span style="color:#666">1</span>,<span style="color:#666">7</span>), random<span style="color:#666">.</span>randint(<span style="color:#666">1</span>,<span style="color:#666">3</span>)]
            random<span style="color:#666">.</span>shuffle(choices)
            days_per_week, weeks <span style="color:#666">=</span> choices
        <span style="color:#008000;font-weight:bold">else</span>:
            days_per_week <span style="color:#666">=</span> random<span style="color:#666">.</span>randint(<span style="color:#666">4</span>,<span style="color:#666">7</span>)
            weeks <span style="color:#666">=</span> random<span style="color:#666">.</span>randint(<span style="color:#666">4</span>,<span style="color:#666">7</span>)

        <span style="color:#008000;font-weight:bold">if</span> self<span style="color:#666">.</span>mild:
            trouble, sleep, personal, work <span style="color:#666">=</span> [False] <span style="color:#666">*</span> <span style="color:#666">4</span>
        <span style="color:#008000;font-weight:bold">else</span>:
            options <span style="color:#666">=</span> [True] <span style="color:#666">+</span> random<span style="color:#666">.</span>choices([True, False], k<span style="color:#666">=</span><span style="color:#666">3</span>)
            random<span style="color:#666">.</span>shuffle(options)
            trouble, sleep, personal, work <span style="color:#666">=</span> options

        <span style="color:#008000;font-weight:bold">return</span> [self<span style="color:#666">.</span>patient_id, days_per_week, weeks, trouble, sleep, personal, work]
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">num_patients <span style="color:#666">=</span> <span style="color:#666">5000</span>

<span style="color:#408080;font-style:italic">## From reference (2)</span>
<span style="color:#408080;font-style:italic">## mild intermittent, mild persistent, mod intermittent, mod persistent</span>
choices <span style="color:#666">=</span> [(True, True), (False, True), (True, False), (False, False)]
props <span style="color:#666">=</span> [<span style="color:#666">0.274</span>, <span style="color:#666">0.208</span>, <span style="color:#666">0.171</span>, <span style="color:#666">0.347</span>]

classes <span style="color:#666">=</span> random<span style="color:#666">.</span>choices(choices, props, k<span style="color:#666">=</span>num_patients)
ids <span style="color:#666">=</span> random<span style="color:#666">.</span>sample(<span style="color:#008000">range</span>(<span style="color:#666">1000000</span>), k<span style="color:#666">=</span>num_patients)

inputs <span style="color:#666">=</span> [(<span style="color:#ba2121">&#34;{0:06d}&#34;</span><span style="color:#666">.</span>format(i), <span style="color:#666">*</span>c) <span style="color:#008000;font-weight:bold">for</span> i, c <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">zip</span>(ids, classes)]

data <span style="color:#666">=</span> [Patient(<span style="color:#666">*</span>input_data)<span style="color:#666">.</span>data <span style="color:#008000;font-weight:bold">for</span> input_data <span style="color:#a2f;font-weight:bold">in</span> inputs]

<span style="color:#408080;font-style:italic">## shuffle, though it should already be random...</span>
random<span style="color:#666">.</span>shuffle(data)
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">columns <span style="color:#666">=</span> [<span style="color:#ba2121">&#34;patient_id&#34;</span>,
           <span style="color:#ba2121">&#34;symptoms_days_per_week&#34;</span>,
           <span style="color:#ba2121">&#34;symptoms_consecutive_weeks&#34;</span>,
           <span style="color:#ba2121">&#34;troublesome_symptoms&#34;</span>,
           <span style="color:#ba2121">&#34;disturbed_sleep&#34;</span>,
           <span style="color:#ba2121">&#34;personal_activities_impaired&#34;</span>,
           <span style="color:#ba2121">&#34;work_impaired&#34;</span>]

df <span style="color:#666">=</span> pd<span style="color:#666">.</span>DataFrame(data, columns<span style="color:#666">=</span>columns)<span style="color:#666">.</span>set_index(<span style="color:#ba2121">&#34;patient_id&#34;</span>)
</code></pre></div><p>And we can save our data now.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>to_csv(<span style="color:#ba2121">&#34;cgmnt_input06.csv&#34;</span>)
</code></pre></div><p>We&rsquo;ll make the puzzle to find how many patients have moderate to severe, persistent allergic rhinitis.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">is_mod_persistent</span>(row):
    <span style="color:#008000;font-weight:bold">if</span> (row<span style="color:#666">.</span>symptoms_days_per_week     <span style="color:#666">&gt;=</span> <span style="color:#666">4</span> <span style="color:#a2f;font-weight:bold">and</span>
        row<span style="color:#666">.</span>symptoms_consecutive_weeks <span style="color:#666">&gt;=</span> <span style="color:#666">4</span> <span style="color:#a2f;font-weight:bold">and</span>
        <span style="color:#008000">any</span>([row<span style="color:#666">.</span>troublesome_symptoms,
             row<span style="color:#666">.</span>disturbed_sleep,
             row<span style="color:#666">.</span>personal_activities_impaired,
             row<span style="color:#666">.</span>work_impaired])
       ):
            <span style="color:#008000;font-weight:bold">return</span> True
    <span style="color:#008000;font-weight:bold">return</span> False
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000">sum</span>(df<span style="color:#666">.</span>apply(is_mod_persistent, axis<span style="color:#666">=</span><span style="color:#666">1</span>))
</code></pre></div><pre><code>1758
</code></pre>
<p>We can check if this is similar to our expected proportion:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#666">1758</span> <span style="color:#666">/</span> <span style="color:#666">5000</span>
</code></pre></div><pre><code>0.3516
</code></pre>
<p>Great, that&rsquo;s close enough (considering we used weighted probabilities).</p>
<p>And just to check this is the same as what we actually tried to generate:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000">len</span>([c <span style="color:#008000;font-weight:bold">for</span> c <span style="color:#a2f;font-weight:bold">in</span> classes <span style="color:#008000;font-weight:bold">if</span> c <span style="color:#666">==</span> (False, False)])
</code></pre></div><pre><code>1758
</code></pre>
<p>Great!</p>
<h4 id="references-1">References</h4>
<p>[1] <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2671762/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2671762/</a></p>

            </section>

        </article>
    </section>

    
    <footer>Contact us at <code> contact at cigmah dot org </code>.
</footer>
    

</section>


        </main>


    </body>
</html>
