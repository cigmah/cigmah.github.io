<!DOCTYPE html>
<html><head>
    
    
    <title> CIGMAH - Infectious Network </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="2019 Puzzle Hunt - Puzzle 07C">
    <meta name="theme-color" content="#000000" />
    <link rel="icon" href="https://cigmah.org/favicon.ico">
    <script src="https://cigmah.org/js/toggles.js"></script>
    <link type="text/css" rel="stylesheet" href=https://cigmah.org/sass/main.css>
    <link rel="canonical" href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle07/">
</head>
<body>
        <header>

            <nav id="nav-menu-toggle" onClick="toggleNav()">
                <div id="menu-text">â˜°</div>
                <div id="cigmah-brand">
                    <div id="cigmah-icon">
                        <img src="https://cigmah.org/img/cigmah-icon.png">
                    </div>
                    <div id="cigmah-text">
                        CIGMAH
                    </div>
                </div>
            </nav>

            <nav id="nav-bar">

<ul id="nav-link-list" onClick="()">

    <li
        class="nav-link-list-item "
    >
        <a
            class="nav-link-list-link "
            id="nav-cigmah-link"
            href=https://cigmah.org/
        >
            <img id="nav-cigmah-link-icon" src="/img/cigmah-icon-small.png">
            <div>CIGMAH</div>
        </a>
    </li>

  
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/about/
        >
            About
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/events/
        >
            Events
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/tools/
        >
            Tools
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/resources/
        >
            Resources
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/blog/
        >
            Blog
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/contact/
        >
            Contact
        </a>
    </li>
    

    <li
        class="nav-link-list-item"
        id="nav-right-item"
        >
        <a
            href="https://aorta.cigmah.org"
            id="nav-aorta-link"
            class="nav-link-list-link"
        >
            <img id="nav-aorta-link-icon" src="/img/aorta-icon.png">
            <div id="nav-aorta-link">AORTA</div>
        </a>
    </li>
</ul>
</nav>

        </header>

        <main>



<section class="normal-page">
    <article id="side-navigation">
        <article id="toggle-side-navigation-container">

            
            <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle06/" id="back"> &lt;&lt; </a>
            

            <button id="toggle-side-navigation" onClick="toggleSideNav()">Show Articles</button>

            
            <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle08/puzzle08/" id="next"> &gt;&gt; </a>
            

        </article>

        <ul id="side-navigation-list">

            
            <li class="side-navigation-parent">
                <a href="https://cigmah.org/events/">Events</a>
            </li>
            


            <li class="side-navigation-section">
                <a href="https://cigmah.org/events/2019_puzzlehunt/">
                    2019 Puzzle Hunt
                </a>
            </li>

            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle01/">Lost in a Library</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle02/">Metabolic Mayhem</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle03/">Combo Catcher</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle04/">Troubled Test</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle05/">Out of Sync</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle06/">While You&#39;re Waiting</a>
            </li>
            
            <li
                class="side-navigation-item  active "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle07/">Infectious Network</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle08/puzzle08/">Tarsal Tumble</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle09/puzzle09/">Fundal Flow</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle10/">Bite Cell Scouting</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle11/puzzle11/">NeuroLogic</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle12/">Reschedule All</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle13/puzzle13/">Allele Inference</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle14/puzzle14/">Base in Balance</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle15/puzzle15/">Worst Offender</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle16/puzzle16/">STI Bugs&#39;n&#39;Drugs</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle17/puzzle17/">What Dipstick?</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle18/puzzle18/">Peak Flow Diary</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle19/puzzle19/">HPV Profiling</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle20/puzzle20/">Code Broadcast</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle21/puzzle21/">Genetic Thrift</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle22/puzzle22/">Neural Decoding</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle23/puzzle23/">Run! (Preclinical)</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle24/puzzle24/">Run! (Clinical)</a>
            </li>
            

        </ul>

    </article>

    <section id="container">

        <article id="content">
            <header id="content-header">
            <h1 id="content-title"> Infectious Network </h1>

            
                <div id="subtitle">
                    <div> 2019 Puzzle Hunt - Puzzle 07C </div>
                </div>
            

            </div>

            </header>

            <section id="content-body">
                <blockquote>
<p>This puzzle was released on 2019-03-09, and was the Challenge puzzle for the theme <em>Automatic, Automata</em>.</p>
</blockquote>
<p>It&rsquo;s 1:40am. Facing North, you walk through the corridor on the 5th wall.</p>
<p><img src="https://i.imgur.com/UAkON0z.gif" alt="Image"></p>
<p>You open the book on the table. Its cover says <strong>Expedition Logs - Star Runner II</strong>.</p>
<p>You start reading.</p>
<blockquote>
<h3 id="10th-march-2050">10th March 2050</h3>
</blockquote>
<blockquote>
<p><strong>Yuen</strong>&lsquo;s got The Cold today. This darn, mysterious Cold which seems to be making its rounds through the crew. While it doesn&rsquo;t seem deadly, it&rsquo;s been putting a stopper in our team morale. It seems to <strong>last for only one day</strong>, which we&rsquo;re thankful for, but we&rsquo;re worried it might have more sinister side effects - some of our group are expecting children and we have to be vigilant in case it&rsquo;s another infectious teratogen. We also cannot afford to endanger Silver Sun with an unknown infection. We must move fast.</p>
</blockquote>
<blockquote>
<p>We remain isolated. <strong>None of our expedition of 100 people has gotten in contact with anyone outside our group since the new year.</strong> Until we know what this disease is, we should keep it that way.</p>
</blockquote>
<blockquote>
<p>It seems most likely that <strong>one person</strong> had The Cold when we began our expedition <strong>on January 1st</strong> and was able to infect another person on that day. We suspect transmission is through air droplet exposure, with the natural history of The Cold appearing to be:</p>
</blockquote>
<blockquote>
<ol>
<li>Day X: A person contracts The Cold from an infected host (but is not infectious on the day they contract it).</li>
<li>Day X + 1: The person is <strong>infectious</strong> and symptomatic during the duration of this day and can transmit it to another person.</li>
<li>Day X + 2 and onward: The person is no longer infectious or symptomatic, and is now <strong>immune</strong> to The Cold (and <strong>can no longer be reinfected</strong>).</li>
</ol>
</blockquote>
<blockquote>
<p>The Cold <strong>does not always transmit when a person meets an infected host</strong> - however, as the cold is only infectious for one day, the fact that it remains among us means <strong>we can deduce that at least one person has contracted the cold every day from a host infected the previous day</strong>.</p>
</blockquote>
<blockquote>
<p>This is vital information. It means <strong>we can trace a path from host to host from an infect<em>ious</em> host on January 1st, to Yuen who is infect<em>ious</em> today on March 10th</strong> (i.e. <strong>Yuen contracted The Cold yesterday by meeting an infected host on March 9th</strong>, who themselves contracted The Cold by meeting an infected host on March 8th, and so on).</p>
</blockquote>
<blockquote>
<p>We are fortunate that the ship has kept a log of <strong>all meetings between two people</strong> on each day of our expedition so far (from January 1st 2050 to March 9th 2050 inclusive). We can use this list of meetings to trace the infection back and hopefully arrive at single possible path that satisfies the constraints of the natural history of the cold. This is not as simple as it seems, as our crew is very tightly integrated: <strong>crew members may meet mutiple people per day</strong>. Backtracking is not as simple as it may seem as we must explore all possibilities: for example, if Clinton is infect<em>ious</em> today and met Alexander and Benson the previous day, we cannot know whether it was Alexander or Benson who was the infected host - we need to search through both possibilities. As you can imagine, the number of possibilities may grow rapidly as possibilities continue to branch off - when searching through the assumption that it was Alexander who was the host that day, if Alexander met Derekson and Emerald the day before, we also cannot know whether it was Derekson or Emerald who was the infected host and again we have to explore both possibilities separately, as well as those for Benson. We can only <strong>exclude</strong> possibilities once we are certain they violate the constraints of the natural history of the cold or the meeting trail does not extend back to January 1st.</p>
</blockquote>
<blockquote>
<p>If we can trace the infection back to the <strong>person who was infect<em>ious</em> on January 1st</strong>, perhaps we can find out where it came from and stop it spreading further - both inside and outside our expedition. Many of our crew have been crew members on other ships; once we have established the source of our infection here, we can perhaps trace even further back and get to the bottom of The Cold. We have experienced too many cases where something innocuous has emerged as something deadly. We cannot afford to be complacent again.</p>
</blockquote>
<p>That sounds ominous. It must have been scary to be in an isolated environment with an unknown infection passing through. They even capitalised &ldquo;The Cold&rdquo; - that means business&hellip;</p>
<p>It looks like you&rsquo;ve got a list of meetings - each meeting consists of a date, a first person in that meeting and a second person in that meeting. A cursory look shows you that the order of the first person and second person within a meeting is just alphabetical order. You suppose you&rsquo;ll have to use the information above to find the person who was infectious on January 1st.</p>
<h2 id="input">Input</h2>
<p><a href="https://drive.google.com/open?id=1QpkZKuHlZWZrqQieGjGLpU2bzB1oQNxf">cgmnt_input07.csv</a> (89KB)</p>
<h2 id="statement">Statement</h2>
<p>State the name of the person who brought the infection to the expedition. (i.e. who was infect<em>ious</em> on January 1st 2050). (e.g. <code>YUEN</code>)</p>
<h2 id="references">References</h2>
<p>Written by the CIGMAH Puzzle Hunt Team with passing reference to <em>Silversun</em> broadcast by the ABC.</p>
<h2 id="answer">Answer</h2>
<p>The correct solution was <code>SCHOLZE</code>.</p>
<h2 id="explanation">Explanation</h2>
<h3 id="map-hint">Map Hint</h3>
<p>You wonder what ever happened to the crew of Star Runner II. You wonder&hellip;but it seems like you&rsquo;ll never know.</p>
<p>You open <code>map_hint.txt</code>. It contains only one word:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">vigenere
</code></pre></div><p>Hm. It looks like it&rsquo;s going to be a long morning&hellip;</p>
<h3 id="writers-notes">Writer&rsquo;s Notes</h3>
<h4 id="objectives">Objectives</h4>
<ol>
<li>Use constraint programming, recursive search strategies or otherwise to traverse a graph</li>
<li>Practise applying programming principles to a simple infection model to gather useful information.</li>
</ol>
<h4 id="context">Context</h4>
<p>Examining the spread of infection from host to host can be fairly arduous to do manually, but becomes much easier when we can automate the modelling process. Infection models are a highly studied topic within the medical field, and with great relevance to population health. Sometimes, we can even establish information such as where an infection came from - tracing infections back using a valid model of their behaviour, while perhaps unrealistic, is an interesting problem to solve.</p>
<p>We hoped to present a simple case which we intended to be solved with constraint programming (though there are of course, other methods!). Using abstracted declarative programming methods may be one option for medical personnel who do not have time to invest in learning the finer implementations of algorithms, but still want to be able to use programming to automate some tasks. In such cases, learning how to define <em>what</em> is desired rather than <em>how</em> to achieve it may be a viable, useful and enjoyable endeavour. As programming languages evolve and paradigms shift, perhaps logic programming (already known for use in medical expert systems) could become more prevalent within the general medical community.</p>
<h4 id="example-solution">Example Solution</h4>
<blockquote>
<p>Note: our example solutions are just one way of approaching the puzzle. They are not necessarily the best way, or even a good way!</p>
</blockquote>
<p>We solved the puzzle using Constraint Programming which was easy to write though not the fastest to run (for this particular puzzle, it probably didn&rsquo;t matter so much - our solution still completes in under one second). We imagine some of our participants would solve this by implementing their own recursive depth-first search, which could perhaps be optimised more finely than ours.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">pd</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">np</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">constraint</span> <span style="color:#008000;font-weight:bold">import</span> <span style="color:#666">*</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">datetime</span> <span style="color:#008000;font-weight:bold">import</span> datetime, timedelta

data <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_csv(<span style="color:#ba2121">&#34;https://drive.google.com/uc?id=1QpkZKuHlZWZrqQieGjGLpU2bzB1oQNxf&#34;</span>, header<span style="color:#666">=</span>None, names<span style="color:#666">=</span>[<span style="color:#ba2121">&#34;date&#34;</span>, <span style="color:#ba2121">&#34;first&#34;</span>, <span style="color:#ba2121">&#34;second&#34;</span>])
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic">### We are given these values</span>
last_infected <span style="color:#666">=</span> <span style="color:#ba2121">&#34;YUEN&#34;</span>
last_date <span style="color:#666">=</span> <span style="color:#ba2121">&#34;2050-03-09&#34;</span> <span style="color:#408080;font-style:italic"># of the meetings we have</span>
start_date <span style="color:#666">=</span> <span style="color:#ba2121">&#34;2050-01-01&#34;</span> <span style="color:#408080;font-style:italic"># of the meetings we have</span>
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic">### Preprocessing</span>
<span style="color:#408080;font-style:italic">### -------------</span>

<span style="color:#408080;font-style:italic">### Convert possible names to id numbers</span>
unique_names <span style="color:#666">=</span> <span style="color:#008000">list</span>(<span style="color:#008000">set</span>(pd<span style="color:#666">.</span>concat([data[<span style="color:#ba2121">&#34;first&#34;</span>], data[<span style="color:#ba2121">&#34;second&#34;</span>]])))
id_to_name <span style="color:#666">=</span> {i:n <span style="color:#008000;font-weight:bold">for</span> i, n <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">enumerate</span>(unique_names)}
name_to_id <span style="color:#666">=</span> {n:i <span style="color:#008000;font-weight:bold">for</span> i, n <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">enumerate</span>(unique_names)}
domain <span style="color:#666">=</span> <span style="color:#008000">list</span>(<span style="color:#008000">range</span>(<span style="color:#008000">len</span>(unique_names)))

data[<span style="color:#ba2121">&#34;first&#34;</span>] <span style="color:#666">=</span> data[<span style="color:#ba2121">&#34;first&#34;</span>]<span style="color:#666">.</span>apply(<span style="color:#008000;font-weight:bold">lambda</span> x: name_to_id[x])
data[<span style="color:#ba2121">&#34;second&#34;</span>] <span style="color:#666">=</span> data[<span style="color:#ba2121">&#34;second&#34;</span>]<span style="color:#666">.</span>apply(<span style="color:#008000;font-weight:bold">lambda</span> x: name_to_id[x])

<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">next_date</span>(date):
    fmt <span style="color:#666">=</span> <span style="color:#ba2121">&#34;%Y-%m-</span><span style="color:#b68;font-weight:bold">%d</span><span style="color:#ba2121">&#34;</span>
    <span style="color:#008000;font-weight:bold">return</span> (datetime<span style="color:#666">.</span>strptime(date, fmt) <span style="color:#666">+</span> timedelta(days<span style="color:#666">=</span><span style="color:#666">1</span>))<span style="color:#666">.</span>strftime(fmt)

dates <span style="color:#666">=</span> <span style="color:#008000">list</span>(<span style="color:#008000">set</span>(data[<span style="color:#ba2121">&#34;date&#34;</span>]))
next_dates <span style="color:#666">=</span> {date: next_date(date) <span style="color:#008000;font-weight:bold">for</span> date <span style="color:#a2f;font-weight:bold">in</span> dates}

dataset <span style="color:#666">=</span> <span style="color:#008000">set</span>(data<span style="color:#666">.</span>apply(<span style="color:#008000">tuple</span>, axis<span style="color:#666">=</span><span style="color:#666">1</span>))

<span style="color:#408080;font-style:italic">### Constraint solution</span>
<span style="color:#408080;font-style:italic">### --------------------</span>

problem <span style="color:#666">=</span> Problem()

<span style="color:#408080;font-style:italic">### Include all the meetings dates, plus the day after the last date</span>
<span style="color:#408080;font-style:italic">### This is so we have consistency (i.e. dates are defined as when someone is infect*ious*)</span>
problem<span style="color:#666">.</span>addVariables(dates <span style="color:#666">+</span> [next_dates[last_date]], domain)

<span style="color:#408080;font-style:italic">### Beginning constraints</span>
<span style="color:#408080;font-style:italic">### Yuen was infect*ious* on the day after the last day of the meeting set</span>
problem<span style="color:#666">.</span>addConstraint(<span style="color:#008000;font-weight:bold">lambda</span> x: x <span style="color:#666">==</span> name_to_id[last_infected], [next_dates[last_date]])

<span style="color:#408080;font-style:italic">### People cannot get the infection twice (i.e. each date must have a unique infect*ious* person)</span>
problem<span style="color:#666">.</span>addConstraint(AllDifferentConstraint())

<span style="color:#408080;font-style:italic">### There must be a meeting between the infect*ious* person of a day and the infect*ious* person of the previous day</span>
<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">add_constraint</span>(day):
    problem<span style="color:#666">.</span>addConstraint(<span style="color:#008000;font-weight:bold">lambda</span> a, b: ((day, a, b) <span style="color:#a2f;font-weight:bold">in</span> dataset) <span style="color:#a2f;font-weight:bold">or</span> ((day, b, a) <span style="color:#a2f;font-weight:bold">in</span> dataset), [day, next_dates[day]])

<span style="color:#008000;font-weight:bold">for</span> date <span style="color:#a2f;font-weight:bold">in</span> dates:
    add_constraint(date)

solution <span style="color:#666">=</span> problem<span style="color:#666">.</span>getSolution()

<span style="color:#008000;font-weight:bold">print</span>(id_to_name[solution[start_date]])
</code></pre></div><pre><code>SCHOLZE
</code></pre>
<h4 id="extra-notes">Extra Notes</h4>
<p>We can also verify that this is the only solution.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">print</span>(<span style="color:#008000">len</span>(problem<span style="color:#666">.</span>getSolutions()))
</code></pre></div><pre><code>1
</code></pre>
<p>And trace the path of infection from host to host:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">datetimed <span style="color:#666">=</span> {datetime<span style="color:#666">.</span>strptime(d, <span style="color:#ba2121">&#34;%Y-%m-</span><span style="color:#b68;font-weight:bold">%d</span><span style="color:#ba2121">&#34;</span>):solution[d] <span style="color:#008000;font-weight:bold">for</span> d <span style="color:#a2f;font-weight:bold">in</span> solution<span style="color:#666">.</span>keys()}
sorted_solution_datetimes <span style="color:#666">=</span> <span style="color:#008000">sorted</span>(<span style="color:#008000">list</span>(datetimed))
[<span style="color:#008000;font-weight:bold">print</span>(<span style="color:#ba2121">&#34;Infectious on {}: {}&#34;</span><span style="color:#666">.</span>format(datetime<span style="color:#666">.</span>strftime(d, <span style="color:#ba2121">&#34;%Y-%m-</span><span style="color:#b68;font-weight:bold">%d</span><span style="color:#ba2121">&#34;</span>),
                                     id_to_name[datetimed[d]]))
 <span style="color:#008000;font-weight:bold">for</span> d <span style="color:#a2f;font-weight:bold">in</span> sorted_solution_datetimes]
<span style="color:#008000;font-weight:bold">print</span>()
</code></pre></div><pre><code>Infectious on 2050-01-01: SCHOLZE
Infectious on 2050-01-02: LEPINE
Infectious on 2050-01-03: MARURI
Infectious on 2050-01-04: HALABURDA
Infectious on 2050-01-05: CHISCHILLY
Infectious on 2050-01-06: DINKELMAN
Infectious on 2050-01-07: VALLARINO
Infectious on 2050-01-08: SOWRY
Infectious on 2050-01-09: MORGRIDGE
Infectious on 2050-01-10: KARDOS
Infectious on 2050-01-11: SOBOTKA
Infectious on 2050-01-12: KOESTERER
Infectious on 2050-01-13: VRABLIC
Infectious on 2050-01-14: TRANTINA
Infectious on 2050-01-15: BARKELL
Infectious on 2050-01-16: ALKHATEEB
Infectious on 2050-01-17: KROPIK
Infectious on 2050-01-18: DEADMOND
Infectious on 2050-01-19: WENNDT
Infectious on 2050-01-20: ELHART
Infectious on 2050-01-21: FUQUAY
Infectious on 2050-01-22: STRICKLETT
Infectious on 2050-01-23: NAM
Infectious on 2050-01-24: BOEGLI
Infectious on 2050-01-25: VANLOO
Infectious on 2050-01-26: THUN
Infectious on 2050-01-27: HIMEBAUGH
Infectious on 2050-01-28: MAJKA
Infectious on 2050-01-29: LEICK
Infectious on 2050-01-30: GAHR
Infectious on 2050-01-31: MOSKOW
Infectious on 2050-02-01: BOEHMLER
Infectious on 2050-02-02: KERRISON
Infectious on 2050-02-03: PARROW
Infectious on 2050-02-04: ROKUS
Infectious on 2050-02-05: DEKAT
Infectious on 2050-02-06: LINEGAR
Infectious on 2050-02-07: ZDUNICH
Infectious on 2050-02-08: LYCKE
Infectious on 2050-02-09: FORCHIONE
Infectious on 2050-02-10: WIDMER
Infectious on 2050-02-11: CHARRON
Infectious on 2050-02-12: KOPASZ
Infectious on 2050-02-13: RUDQUIST
Infectious on 2050-02-14: RIPPETH
Infectious on 2050-02-15: JENNETT
Infectious on 2050-02-16: STERLACCI
Infectious on 2050-02-17: NIMBLETT
Infectious on 2050-02-18: VILLALOBO
Infectious on 2050-02-19: SPANO
Infectious on 2050-02-20: CIARLEGLIO
Infectious on 2050-02-21: FLIFLET
Infectious on 2050-02-22: CIARDIELLO
Infectious on 2050-02-23: TUDOR
Infectious on 2050-02-24: JULY
Infectious on 2050-02-25: KOTTE
Infectious on 2050-02-26: COFFEN
Infectious on 2050-02-27: CRIPPIN
Infectious on 2050-02-28: STRAUBINGER
Infectious on 2050-03-01: GRIJALVA
Infectious on 2050-03-02: KUHNLE
Infectious on 2050-03-03: CIOCHON
Infectious on 2050-03-04: GERSHKOVICH
Infectious on 2050-03-05: COKE
Infectious on 2050-03-06: MOWDAY
Infectious on 2050-03-07: HIRSCHLER
Infectious on 2050-03-08: EMBRY
Infectious on 2050-03-09: ZAFAR
Infectious on 2050-03-10: YUEN
</code></pre>
<h4 id="data-generation">Data Generation</h4>
<p>The infectious network input will consist of a list of meetings between people.</p>
<p>To construct the infectious network, we need to construct an <code>(n, 3)</code> matrix (<code>n</code> rows, <code>3</code> columns) with:</p>
<ol>
<li>The datetime of the meeting</li>
<li>The name of the first person in the meeting</li>
<li>The name of the second person in the meeting.</li>
</ol>
<p>The names of the first and second person will simply be in alphabetical order.</p>
<p>To create these tuples, we need to decide:</p>
<ol>
<li>What the datetime range will be</li>
<li>What the name pool will be</li>
</ol>
<p>At each generation step, we will enforce that a randomly selected case contribute to the &ldquo;solution path&rdquo; - i.e. we start by selecting a random case, generating a meeting, then follow the person they met to generate the next meeting and so on. At the end, we will solve to find solution paths and remove nodes to disrupt every solution path but one to ensure our solution is unique.</p>
<h5 id="name-source">Name Source</h5>
<p>We will use names from the <code>surnames</code> dataset provided as a public material by the Princeton Intro to Programming course, itself derived from a <a href="https://www.census.gov/topics/population/genealogy/data/2000_surnames.html">public dataset by the US Census Bureau</a>.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">pandas</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">pd</span>

surnames <span style="color:#666">=</span> pd<span style="color:#666">.</span>read_csv(<span style="color:#ba2121">&#34;https://introcs.cs.princeton.edu/java/data/surnames.csv&#34;</span>)
</code></pre></div><p>We&rsquo;ll use 100 names for our data generation.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">random</span>

num_names <span style="color:#666">=</span> <span style="color:#666">100</span>
names <span style="color:#666">=</span> random<span style="color:#666">.</span>sample(<span style="color:#008000">list</span>(surnames<span style="color:#666">.</span>name), k<span style="color:#666">=</span>num_names)
name_set <span style="color:#666">=</span> <span style="color:#008000">set</span>(names)
</code></pre></div><h5 id="datetime-range">Datetime Range</h5>
<p>We&rsquo;ll choose an arbitrary start date of Jan 1st 2050 and proceed until 67 days after that.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">time</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">datetime</span>

start_date <span style="color:#666">=</span> datetime<span style="color:#666">.</span>date(<span style="color:#666">2050</span>, <span style="color:#666">1</span>, <span style="color:#666">1</span>)
unix_start <span style="color:#666">=</span> time<span style="color:#666">.</span>mktime(start_date<span style="color:#666">.</span>timetuple())
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">num_days <span style="color:#666">=</span> <span style="color:#666">67</span>
unix_end <span style="color:#666">=</span> unix_start <span style="color:#666">+</span> (num_days <span style="color:#666">*</span> <span style="color:#666">24</span> <span style="color:#666">*</span> <span style="color:#666">60</span> <span style="color:#666">*</span> <span style="color:#666">60</span>)
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">datetime<span style="color:#666">.</span>datetime<span style="color:#666">.</span>utcfromtimestamp(unix_end)<span style="color:#666">.</span>date()
</code></pre></div><pre><code>datetime.date(2050, 3, 9)
</code></pre>
<p>So we end up on March 9th on the 67th day after Jan 1st 2050. Perfect timing for the puzzle!</p>
<h5 id="meetings">Meetings</h5>
<p>We&rsquo;ll define a function to make meetings of two types - random meeting, and solution meeting (which will guarantee us that at least one solution exists). The solution meeting will take the name of a previously infected person and an exclusion list and return a new meeting that includes the infected person and does not include someone in the exclusion list.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">make_meeting</span>(day_num, infected<span style="color:#666">=</span>False, exclusions<span style="color:#666">=</span>False):
    <span style="color:#ba2121">&#34;&#34;&#34; Make a 3-element tuple representing a meeting.
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">    Uses global variables:
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">        unix_start : start datetime in unix time
</span><span style="color:#ba2121">        names : list of possible names
</span><span style="color:#ba2121">        name_set : set of possible names
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">    Args:
</span><span style="color:#ba2121">        day_num (int) : the day number of the meeting.
</span><span style="color:#ba2121">        infected (string) : the infected person to include.
</span><span style="color:#ba2121">        exclusions (list of strings) : required if infected meeting.
</span><span style="color:#ba2121">                    The meeting will not include these people
</span><span style="color:#ba2121">                    (previously infected, and hence cannot be reinfected).
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">    Returns:
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">        3-element tuple correspond to:
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">            1. Datetime of meeting
</span><span style="color:#ba2121">            2. First person in meeting
</span><span style="color:#ba2121">            3. Second person in meeting
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">        Also returns newly infected name (or None)
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">        First and second person are ordered alphabetically.
</span><span style="color:#ba2121">
</span><span style="color:#ba2121">    &#34;&#34;&#34;</span>

    <span style="color:#008000;font-weight:bold">if</span> infected <span style="color:#a2f;font-weight:bold">and</span> exclusions:
        allowed <span style="color:#666">=</span> <span style="color:#008000">list</span>(<span style="color:#008000">set</span>(names) <span style="color:#666">-</span> <span style="color:#008000">set</span>(exclusions))
        new_infection <span style="color:#666">=</span> random<span style="color:#666">.</span>choice(allowed)
        selected <span style="color:#666">=</span> <span style="color:#008000">sorted</span>([infected, new_infection])
    <span style="color:#008000;font-weight:bold">else</span>:
        selected <span style="color:#666">=</span> <span style="color:#008000">sorted</span>(random<span style="color:#666">.</span>sample(names, k<span style="color:#666">=</span><span style="color:#666">2</span>))
        new_infection <span style="color:#666">=</span> None

    unix_date <span style="color:#666">=</span> unix_start <span style="color:#666">+</span> (day_num <span style="color:#666">*</span> <span style="color:#666">24</span> <span style="color:#666">*</span> <span style="color:#666">60</span> <span style="color:#666">*</span> <span style="color:#666">60</span>)
    date <span style="color:#666">=</span> datetime<span style="color:#666">.</span>datetime<span style="color:#666">.</span>utcfromtimestamp(unix_date)<span style="color:#666">.</span>date()

    <span style="color:#008000;font-weight:bold">return</span> (date, selected[<span style="color:#666">0</span>], selected[<span style="color:#666">1</span>]), new_infection
</code></pre></div><p>We&rsquo;ll make between 45 and 55 meetings per day.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">contagious_days <span style="color:#666">=</span> <span style="color:#666">1</span>
num_meetings_per_day <span style="color:#666">=</span> <span style="color:#666">50</span>

next_infection_day <span style="color:#666">=</span> <span style="color:#666">0</span>
last_infected <span style="color:#666">=</span> <span style="color:#ba2121">&#34;&#34;</span>

infection_list <span style="color:#666">=</span> []
infection_meetings <span style="color:#666">=</span> []
meetings <span style="color:#666">=</span> []

<span style="color:#008000;font-weight:bold">for</span> day <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(num_days <span style="color:#666">+</span> <span style="color:#666">1</span>):
    num_meetings <span style="color:#666">=</span> random<span style="color:#666">.</span>randint(num_meetings_per_day <span style="color:#666">-</span> <span style="color:#666">5</span>, num_meetings_per_day <span style="color:#666">+</span> <span style="color:#666">5</span>)
    meetings <span style="color:#666">+=</span> [make_meeting(day)[<span style="color:#666">0</span>] <span style="color:#008000;font-weight:bold">for</span> i <span style="color:#a2f;font-weight:bold">in</span> <span style="color:#008000">range</span>(num_meetings)]

    <span style="color:#008000;font-weight:bold">if</span> day <span style="color:#666">==</span> next_infection_day:
        <span style="color:#008000;font-weight:bold">if</span> last_infected:
            infected_meeting, infected <span style="color:#666">=</span> make_meeting(day, infected<span style="color:#666">=</span>last_infected, exclusions<span style="color:#666">=</span>infection_list)

        <span style="color:#008000;font-weight:bold">else</span>: <span style="color:#408080;font-style:italic"># first infection</span>
            infected_meeting <span style="color:#666">=</span> make_meeting(day)[<span style="color:#666">0</span>]

            i_options <span style="color:#666">=</span> [<span style="color:#666">1</span>, <span style="color:#666">2</span>]
            random<span style="color:#666">.</span>shuffle(i_options)

            infected <span style="color:#666">=</span> infected_meeting[i_options[<span style="color:#666">0</span>]]
            infection_list<span style="color:#666">.</span>append(infected_meeting[i_options[<span style="color:#666">1</span>]])

        last_infected <span style="color:#666">=</span> infected
        next_infection_day <span style="color:#666">=</span> day <span style="color:#666">+</span> (random<span style="color:#666">.</span>randint(<span style="color:#666">1</span>,contagious_days))

        infection_list<span style="color:#666">.</span>append(infected)
        infection_meetings<span style="color:#666">.</span>append(infected_meeting)
        meetings<span style="color:#666">.</span>append(infected_meeting)
</code></pre></div><p>And here&rsquo;s the generated list of meetings in the infection path:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">infection_meetings
</code></pre></div><pre><code>[(datetime.date(2050, 1, 1), 'LEPINE', 'SCHOLZE'),
 (datetime.date(2050, 1, 2), 'LEPINE', 'MARURI'),
 (datetime.date(2050, 1, 3), 'HALABURDA', 'MARURI'),
 (datetime.date(2050, 1, 4), 'CHISCHILLY', 'HALABURDA'),
 (datetime.date(2050, 1, 5), 'CHISCHILLY', 'DINKELMAN'),
 (datetime.date(2050, 1, 6), 'DINKELMAN', 'VALLARINO'),
 (datetime.date(2050, 1, 7), 'SOWRY', 'VALLARINO'),
 (datetime.date(2050, 1, 8), 'MORGRIDGE', 'SOWRY'),
 (datetime.date(2050, 1, 9), 'KARDOS', 'MORGRIDGE'),
 (datetime.date(2050, 1, 10), 'KARDOS', 'SOBOTKA'),
 (datetime.date(2050, 1, 11), 'KOESTERER', 'SOBOTKA'),
 (datetime.date(2050, 1, 12), 'KOESTERER', 'VRABLIC'),
 (datetime.date(2050, 1, 13), 'TRANTINA', 'VRABLIC'),
 (datetime.date(2050, 1, 14), 'BARKELL', 'TRANTINA'),
 (datetime.date(2050, 1, 15), 'ALKHATEEB', 'BARKELL'),
 (datetime.date(2050, 1, 16), 'ALKHATEEB', 'KROPIK'),
 (datetime.date(2050, 1, 17), 'DEADMOND', 'KROPIK'),
 (datetime.date(2050, 1, 18), 'DEADMOND', 'WENNDT'),
 (datetime.date(2050, 1, 19), 'ELHART', 'WENNDT'),
 (datetime.date(2050, 1, 20), 'ELHART', 'FUQUAY'),
 (datetime.date(2050, 1, 21), 'FUQUAY', 'STRICKLETT'),
 (datetime.date(2050, 1, 22), 'NAM', 'STRICKLETT'),
 (datetime.date(2050, 1, 23), 'BOEGLI', 'NAM'),
 (datetime.date(2050, 1, 24), 'BOEGLI', 'VANLOO'),
 (datetime.date(2050, 1, 25), 'THUN', 'VANLOO'),
 (datetime.date(2050, 1, 26), 'HIMEBAUGH', 'THUN'),
 (datetime.date(2050, 1, 27), 'HIMEBAUGH', 'MAJKA'),
 (datetime.date(2050, 1, 28), 'LEICK', 'MAJKA'),
 (datetime.date(2050, 1, 29), 'GAHR', 'LEICK'),
 (datetime.date(2050, 1, 30), 'GAHR', 'MOSKOW'),
 (datetime.date(2050, 1, 31), 'BOEHMLER', 'MOSKOW'),
 (datetime.date(2050, 2, 1), 'BOEHMLER', 'KERRISON'),
 (datetime.date(2050, 2, 2), 'KERRISON', 'PARROW'),
 (datetime.date(2050, 2, 3), 'PARROW', 'ROKUS'),
 (datetime.date(2050, 2, 4), 'DEKAT', 'ROKUS'),
 (datetime.date(2050, 2, 5), 'DEKAT', 'LINEGAR'),
 (datetime.date(2050, 2, 6), 'LINEGAR', 'ZDUNICH'),
 (datetime.date(2050, 2, 7), 'LYCKE', 'ZDUNICH'),
 (datetime.date(2050, 2, 8), 'FORCHIONE', 'LYCKE'),
 (datetime.date(2050, 2, 9), 'FORCHIONE', 'WIDMER'),
 (datetime.date(2050, 2, 10), 'CHARRON', 'WIDMER'),
 (datetime.date(2050, 2, 11), 'CHARRON', 'KOPASZ'),
 (datetime.date(2050, 2, 12), 'KOPASZ', 'RUDQUIST'),
 (datetime.date(2050, 2, 13), 'RIPPETH', 'RUDQUIST'),
 (datetime.date(2050, 2, 14), 'JENNETT', 'RIPPETH'),
 (datetime.date(2050, 2, 15), 'JENNETT', 'STERLACCI'),
 (datetime.date(2050, 2, 16), 'NIMBLETT', 'STERLACCI'),
 (datetime.date(2050, 2, 17), 'NIMBLETT', 'VILLALOBO'),
 (datetime.date(2050, 2, 18), 'SPANO', 'VILLALOBO'),
 (datetime.date(2050, 2, 19), 'CIARLEGLIO', 'SPANO'),
 (datetime.date(2050, 2, 20), 'CIARLEGLIO', 'FLIFLET'),
 (datetime.date(2050, 2, 21), 'CIARDIELLO', 'FLIFLET'),
 (datetime.date(2050, 2, 22), 'CIARDIELLO', 'TUDOR'),
 (datetime.date(2050, 2, 23), 'JULY', 'TUDOR'),
 (datetime.date(2050, 2, 24), 'JULY', 'KOTTE'),
 (datetime.date(2050, 2, 25), 'COFFEN', 'KOTTE'),
 (datetime.date(2050, 2, 26), 'COFFEN', 'CRIPPIN'),
 (datetime.date(2050, 2, 27), 'CRIPPIN', 'STRAUBINGER'),
 (datetime.date(2050, 2, 28), 'GRIJALVA', 'STRAUBINGER'),
 (datetime.date(2050, 3, 1), 'GRIJALVA', 'KUHNLE'),
 (datetime.date(2050, 3, 2), 'CIOCHON', 'KUHNLE'),
 (datetime.date(2050, 3, 3), 'CIOCHON', 'GERSHKOVICH'),
 (datetime.date(2050, 3, 4), 'COKE', 'GERSHKOVICH'),
 (datetime.date(2050, 3, 5), 'COKE', 'MOWDAY'),
 (datetime.date(2050, 3, 6), 'HIRSCHLER', 'MOWDAY'),
 (datetime.date(2050, 3, 7), 'EMBRY', 'HIRSCHLER'),
 (datetime.date(2050, 3, 8), 'EMBRY', 'ZAFAR'),
 (datetime.date(2050, 3, 9), 'YUEN', 'ZAFAR')]
</code></pre>
<h5 id="checking-for-unique-solutions">Checking for Unique Solutions</h5>
<p>We solved the puzzle (using only the information participants would have) using the example solution we wrote above. We were lucky and there was only actually one solution (on a previous iteration, we had 4 and just removed a few nodes) so we could leave it as it was.</p>
<p>We shuffled our input.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">random<span style="color:#666">.</span>shuffle(meetings)
</code></pre></div><p>And formatted the datetimes.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">formatted <span style="color:#666">=</span> [(m[<span style="color:#666">0</span>]<span style="color:#666">.</span>strftime(<span style="color:#ba2121">&#34;%Y-%m-</span><span style="color:#b68;font-weight:bold">%d</span><span style="color:#ba2121">&#34;</span>), m[<span style="color:#666">1</span>], m[<span style="color:#666">2</span>]) <span style="color:#008000;font-weight:bold">for</span> m <span style="color:#a2f;font-weight:bold">in</span> meetings]
</code></pre></div><p>And saved as a DataFrame and CSV.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#666">=</span> pd<span style="color:#666">.</span>DataFrame(formatted)
</code></pre></div><div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#666">.</span>to_csv(<span style="color:#ba2121">&#34;cgmnt_input07.csv&#34;</span>, header<span style="color:#666">=</span>False, index<span style="color:#666">=</span>False)
</code></pre></div>
            </section>

        </article>
    </section>

</section>


        </main>

        <footer><footer>
</footer>
</footer>

    </body>
</html>
