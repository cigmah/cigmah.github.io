
<!DOCTYPE html>
<html><head>
    
    
    <title> CIGMAH - Neural Decoding </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="2019 Puzzle Hunt - Puzzle 22C">
    <meta name="theme-color" content="#000000" />
    <link rel="icon" href="https://cigmah.org/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cigmah.org/js/toggles.js"></script>
    <link type="text/css" rel="stylesheet" href=https://cigmah.org/sass/main.css>
    <link rel="canonical" href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle22/">
</head>
<body>
        <header>

            <nav id="nav-menu-toggle" onClick="toggleNav()">
                <div id="menu-text">â˜°</div>
                <div id="cigmah-brand">
                    <div id="cigmah-icon">
                        <img src="https://cigmah.org/img/cigmah-icon.png">
                    </div>
                    <div id="cigmah-text">
                        CIGMAH
                    </div>
                </div>
            </nav>

            <nav id="nav-bar">

<ul id="nav-link-list" onClick="()">

    <li
        class="nav-link-list-item "
    >
        <a
            class="nav-link-list-link "
            id="nav-cigmah-link"
            href=https://cigmah.org/
        >
            <img id="nav-cigmah-link-icon" src="/img/cigmah-icon-small.png">
            <div>CIGMAH</div>
        </a>
    </li>

  
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/about/
        >
            About
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/events/
        >
            Events
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/tools/
        >
            Tools
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/resources/
        >
            Resources
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/blog/
        >
            Blog
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/contact/
        >
            Contact
        </a>
    </li>
    

    <li
        class="nav-link-list-item"
        id="nav-right-item"
        >
        <a
            href="https://apps.cigmah.org"
            id="nav-aorta-link"
            class="nav-link-list-link"
        >
            <div id="nav-aorta-link">Web Apps</div>
        </a>
    </li>
</ul>
</nav>

        </header>

        <main>



<section class="normal-page">
    <article id="side-navigation">
        <article id="toggle-side-navigation-container">

            
            <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle21/" id="back"> &lt;&lt; </a>
            

            <button id="toggle-side-navigation" onClick="toggleSideNav()">Show Articles</button>

            
            <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle23/" id="next"> &gt;&gt; </a>
            

        </article>

        <ul id="side-navigation-list">

            
            <li class="side-navigation-parent">
                <a href="https://cigmah.org/events/">Events</a>
            </li>
            


            <li class="side-navigation-section">
                <a href="https://cigmah.org/events/2019_puzzlehunt/">
                    2019 Puzzle Hunt
                </a>
            </li>

            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle01/">Lost in a Library</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle02/">Metabolic Mayhem</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle03/">Combo Catcher</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle04/">Troubled Test</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle05/">Out of Sync</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle06/">While You&#39;re Waiting</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle07/">Infectious Network</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle08/">Tarsal Tumble</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle09/">Fundal Flow</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle10/">Bite Cell Scouting</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle11/">NeuroLogic</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle12/">Reschedule All</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle13/">Allele Inference</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle14/">Base in Balance</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle15/">Worst Offender</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle16/">STI Bugs&#39;n&#39;Drugs</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle17/">What Dipstick?</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle18/">Peak Flow Diary</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle19/">HPV Profiling</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle20/">Code Broadcast</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle21/">Genetic Thrift</a>
            </li>
            
            <li
                class="side-navigation-item  active "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle22/">Neural Decoding</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle23/">Run! (Preclinical)</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_puzzlehunt/puzzles/cgmnt-puzzle24/">Run! (Clinical)</a>
            </li>
            

        </ul>

    </article>

    <section id="container">

        <article id="content">
            <header id="content-header">
            <h1 id="content-title"> Neural Decoding </h1>

            
                <div id="subtitle">
                    <div> 2019 Puzzle Hunt - Puzzle 22C </div>
                </div>
            

            </div>

            </header>

            <section id="content-body">
                <blockquote>
<p>This puzzle was released on 2019-08-10, and was the Challenge puzzle for the theme <em>&ldquo;Code&rdquo;</em>.</p>
</blockquote>
<p>It&rsquo;s 6:40am. Facing North, you walk through the corridor on the 6th wall.</p>
<p><img src="https://i.imgur.com/Tr5hqm6.gif" alt="Imgur">
You tell yourself you can only do your best, and to stop berating yourself for getting lost in this library in the first place.</p>
<p>You turn on the computer in the middle of the room.</p>
<hr>
<p>Neurons around the body are able communicate with each other to coordinate the sensory and motor functionality of the human body. The communication within and between neurons is electrochemical in nature and can be measured with a wide variety of neurophysiological recording techniques.</p>
<p>The ability to record neural activity has interesting implications. For example, some patients with motor paralysis may not be able to move one or more limbs of their body due to peripheral neurological causes. <a href="https://en.wikipedia.org/wiki/Brain%E2%80%93computer_interface">However, as the brain is still active, it may be possible to extract meaning out of neural activity in the brain by recording neural activity and mapping this to an interface in the environment, such as a cursor on a computer screen or a prosthetic limb.</a>. One difficulty with these devices, however, is how exactly meaning can be extracted out of measurements of extremely noisy neural activity.</p>
<p>We will consider a hypothetical scenario related to decoding noisy data into something meaningful.</p>
<hr>
<p>You are given an input file, <code>cgmnt_input22_training_data.txt</code> which consists of 12 lines, each containing a sequence of 0s and 1s. Consider each line to represent the recording of a single distinct theoretical neuron with unknown tuning characteristics; 12 neurons are recorded simultaneously. The sequence of 0s and 1s represent neural spikes measured at a frequency of 1000Hz, so for example, the first 1000 digits of the second line correspond to the first 1 second of measurement of the 2nd neuron. In total, you have 240 seconds of training data for 12 simultaneously-recorded neurons.</p>
<p>You are also given a file of labels, <code>cgmnt_input22_training_labels.txt</code>, which contains 240 characters. Each character is one of &lsquo;U&rsquo;, &lsquo;R&rsquo;, &lsquo;D&rsquo;, or &lsquo;L&rsquo;. These characters represent directions (up, right, down and left respectively), which the participant from which the neural data was recorded was instructed to think of during the time the neural data was recorded.</p>
<p>So, for example, the first character of the training labels file is &lsquo;U&rsquo;. This means the first 1 second of the training data file (i.e. the first 1000 digits of each line) is the neural activity expected to correspond to thinking about upward movement, though with added noise. The next character of the labels file is &lsquo;R&rsquo;. This means the next 1 second of the training data file (i.e. the next 1000 digits of each line) is the neural activity expected to corresponding to thinking about rightward movement, though with added noise.</p>
<p>We can use this data to try and extract underlying patterns of neural activity that correspond to the different movements up, right, down and left. These patterns might then be used to determine what direction the participant is thinking of when they are asked to think of directions themselves.</p>
<hr>
<p><strong>Your task</strong> is to determine the movements the patient is thinking of in your file input <code>cgmnt_input_22_test_data.txt</code> and to plot the movement of the cursor on the screen. This file is of similar format to the training data file (i.e. the same 12 neurons recorded at 1000Hz, and with 1 second corresponding to one direction of movement). Plotting the movements will spell a word.</p>
<p>You have also been provided with an <em>example</em> file, <code>cgmnt_input_22_example_data.txt</code>, which is an example of your task which you may use to check that you are extracting movements correctly. The example data contains 36 seconds (i.e. 36000 samples) of neural spike data. Below is a spike raster plot of the <em>example</em> data, where each of the 12 rows corresponds to the stream of 36000 measurements for each of the 12 neurons recorded simultaneously:</p>
<p><img src="https://i.imgur.com/G0ZZ8pO.png" alt="Raster">
A successful decoding of this example data will reveal the 36 movements UUDRUDDRUURLDRLDRRUUDDRRUUDDRRUURDDL, each movement corresponding to 1 second (1000 samples) of data. Plotting this stream of cursor movements will show the following result:</p>
<p><img src="https://i.imgur.com/YeJtLfI.gif" alt="Example"></p>
<p>This spells the word &ldquo;HELLO&rdquo; (you will need to interpret the letter-forms - they spell a meaningful word in your test data).</p>
<p>You must do the same for your test data, which is 44 seconds (44000 samples) long. While in practice, your training data would need to be much larger for this sort of problem, the training and test data we have provided should be sufficient to solve this puzzle.</p>
<h1 id="input">Input</h1>
<p><a href="https://drive.google.com/open?id=1ZGiSzuZ4_js82XwVyZA9DoUoLB_yOhJb">Click here to download your input data (4 .txt files: 422 KB, 516 KB, 3MB and 240 bytes)</a></p>
<h1 id="statement">Statement</h1>
<p>State the word traced out by the <em>test</em> data when it is decoded into a stream of cursor movements.</p>
<h1 id="references">References</h1>
<p>Written by the CIGMAH Puzzle Hunt Team.</p>
<hr>
<h1 id="answer">Answer</h1>
<p>The correct solution was <code>SIGNAL</code>.</p>
<h1 id="explanation">Explanation</h1>
<h2 id="map-hint">Map Hint</h2>
<p>You wonder what the future will look like.</p>
<p>You open the file <code>map_hint.txt</code>. It reads:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">You will arrive at the dead-end room D-H on the last, 25th puzzle.
</code></pre></div><p>What&rsquo;s this?</p>
<h2 id="writers-notes">Writer&rsquo;s Notes</h2>
<p><img src="https://i.imgur.com/y0Iu9hG.gif" alt="Answer"></p>
<p>The answer movements are LDRDLRRUUDDRUURLDDRULRDRUURDDRUURDLRDRUUDDRR.</p>
<p>We really wanted to do a more in-depth write up about this problem, but didn&rsquo;t get time. We may come back to it.</p>
<p>Brief notes:</p>
<ol>
<li>A machine learning approach for this particular problem like we took here is definitely overkill, but it&rsquo;s relatively simple with <code>tf.keras</code> to extract patterns when you don&rsquo;t know what the pattern might be. This particular pattern was very very simple (the underlying signal always occurs for each direction, and the underlying signal for each direction is completely different - the only deterrent is the noise).</li>
<li>Our generated data isn&rsquo;t realistic, but the general idea is similar. We didn&rsquo;t add all that much noise to the data (we added noise as a 33% chance for any particular bit to flip), so a very limited amount of training data was sufficient.</li>
</ol>
<p>Example solution:</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">tensorflow</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">tf</span> <span style="color:#408080;font-style:italic"># tensorflow version 2.0.0 beta</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">numpy</span> <span style="color:#008000;font-weight:bold">as</span> <span style="color:#00f;font-weight:bold">np</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">turtle</span> <span style="color:#008000;font-weight:bold">import</span> <span style="color:#666">*</span>
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">typing</span> <span style="color:#008000;font-weight:bold">import</span> List

<span style="color:#408080;font-style:italic">## Read the training data</span>
<span style="color:#008000;font-weight:bold">with</span> <span style="color:#008000">open</span>(<span style="color:#ba2121">&#39;cgmnt_input22_training_data.txt&#39;</span>) <span style="color:#008000;font-weight:bold">as</span> infile:
    RAW_TRAINING_DATA <span style="color:#666">=</span> infile<span style="color:#666">.</span>readlines()

<span style="color:#008000;font-weight:bold">with</span> <span style="color:#008000">open</span>(<span style="color:#ba2121">&#39;cgmnt_input22_training_labels.txt&#39;</span>) <span style="color:#008000;font-weight:bold">as</span> infile:
    RAW_TRAINING_LABELS <span style="color:#666">=</span> infile<span style="color:#666">.</span>read()

<span style="color:#408080;font-style:italic">## Define directions classes as integers</span>
LABELS_DICT <span style="color:#666">=</span> {
    <span style="color:#ba2121">&#39;U&#39;</span>: <span style="color:#666">0</span>,
    <span style="color:#ba2121">&#39;R&#39;</span>: <span style="color:#666">1</span>,
    <span style="color:#ba2121">&#39;D&#39;</span>: <span style="color:#666">2</span>,
    <span style="color:#ba2121">&#39;L&#39;</span>: <span style="color:#666">3</span>,
}

<span style="color:#408080;font-style:italic">## Define conversion function from data text lines to numpy array in proper shape</span>
<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">to_array</span>(lines: List[<span style="color:#008000">str</span>]) <span style="color:#666">-&gt;</span> np<span style="color:#666">.</span>ndarray:
    <span style="color:#008000;font-weight:bold">return</span> np<span style="color:#666">.</span>array([<span style="color:#008000">list</span>(<span style="color:#008000">map</span>(<span style="color:#008000">int</span>, <span style="color:#008000">list</span>(line<span style="color:#666">.</span>strip()))) <span style="color:#008000;font-weight:bold">for</span> line <span style="color:#a2f;font-weight:bold">in</span> lines])\
          <span style="color:#666">.</span>transpose()\
          <span style="color:#666">.</span>reshape(<span style="color:#666">-</span><span style="color:#666">1</span>, <span style="color:#666">1000</span>, <span style="color:#666">12</span>) <span style="color:#408080;font-style:italic"># trials x samples x channel array</span>

<span style="color:#408080;font-style:italic">## Convert training data to arrays</span>
ARRAY_TRAINING_DATA <span style="color:#666">=</span> to_array(RAW_TRAINING_DATA)
ARRAY_TRAINING_LABELS <span style="color:#666">=</span> tf<span style="color:#666">.</span>one_hot(np<span style="color:#666">.</span>array([LABELS_DICT[c] <span style="color:#008000;font-weight:bold">for</span> c <span style="color:#a2f;font-weight:bold">in</span> RAW_TRAINING_LABELS]), depth<span style="color:#666">=</span><span style="color:#666">4</span>)

<span style="color:#408080;font-style:italic">## Define and fit a model</span>
model <span style="color:#666">=</span> tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>Sequential()
model<span style="color:#666">.</span>add(tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Flatten(input_shape<span style="color:#666">=</span>(<span style="color:#666">1000</span>,<span style="color:#666">12</span>)))
model<span style="color:#666">.</span>add(tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dense(<span style="color:#666">144</span>, activation<span style="color:#666">=</span><span style="color:#ba2121">&#39;relu&#39;</span>))
model<span style="color:#666">.</span>add(tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dense(<span style="color:#666">72</span>, activation<span style="color:#666">=</span><span style="color:#ba2121">&#39;relu&#39;</span>))
model<span style="color:#666">.</span>add(tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dense(<span style="color:#666">48</span>, activation<span style="color:#666">=</span><span style="color:#ba2121">&#39;relu&#39;</span>))
model<span style="color:#666">.</span>add(tf<span style="color:#666">.</span>keras<span style="color:#666">.</span>layers<span style="color:#666">.</span>Dense(<span style="color:#666">4</span>, activation<span style="color:#666">=</span><span style="color:#ba2121">&#39;softmax&#39;</span>))

model<span style="color:#666">.</span>compile(loss<span style="color:#666">=</span><span style="color:#ba2121">&#39;categorical_crossentropy&#39;</span>, optimizer<span style="color:#666">=</span><span style="color:#ba2121">&#39;adam&#39;</span>, metrics<span style="color:#666">=</span>[<span style="color:#ba2121">&#39;accuracy&#39;</span>])
model<span style="color:#666">.</span>fit(ARRAY_TRAINING_DATA, ARRAY_TRAINING_LABELS, epochs<span style="color:#666">=</span><span style="color:#666">10</span>, batch_size<span style="color:#666">=</span><span style="color:#666">10</span>)

<span style="color:#408080;font-style:italic">## Read the example data and process</span>
<span style="color:#408080;font-style:italic">## with open(&#39;cgmnt_input22_example_data.txt&#39;) as infile:</span>
<span style="color:#408080;font-style:italic">##     RAW_EXAMPLE_DATA = infile.readlines()</span>
<span style="color:#408080;font-style:italic">## ARRAY_EXAMPLE_DATA = to_array(RAW_EXAMPLE_DATA)</span>
<span style="color:#408080;font-style:italic">## EXAMPLE_PREDICTIONS = tf.argmax(model.predict(ARRAY_EXAMPLE_DATA), axis=1).numpy().tolist()</span>

<span style="color:#408080;font-style:italic">## Define a drawing function</span>
STEP_SIZE <span style="color:#666">=</span> <span style="color:#666">20</span>
<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">draw_predictions</span>(predictions: List[<span style="color:#008000">int</span>]) <span style="color:#666">-&gt;</span> None:
    <span style="color:#408080;font-style:italic"># Face up first</span>
    left(<span style="color:#666">90</span>)
    <span style="color:#008000;font-weight:bold">for</span> prediction <span style="color:#a2f;font-weight:bold">in</span> predictions:
        <span style="color:#408080;font-style:italic"># Always face up</span>
        <span style="color:#008000;font-weight:bold">if</span> prediction <span style="color:#666">==</span> <span style="color:#666">0</span>:
            forward(STEP_SIZE)
        <span style="color:#008000;font-weight:bold">elif</span> prediction <span style="color:#666">==</span> <span style="color:#666">1</span>:
            right(<span style="color:#666">90</span>)
            forward(STEP_SIZE)
            left(<span style="color:#666">90</span>)
        <span style="color:#008000;font-weight:bold">elif</span> prediction <span style="color:#666">==</span> <span style="color:#666">2</span>:
            right(<span style="color:#666">180</span>)
            forward(STEP_SIZE)
            left(<span style="color:#666">180</span>)
        <span style="color:#008000;font-weight:bold">else</span>:
            left(<span style="color:#666">90</span>)
            forward(STEP_SIZE)
            right(<span style="color:#666">90</span>)
    done()

<span style="color:#408080;font-style:italic">## draw_predictions(EXAMPLE_PREDICTIONS)</span>

<span style="color:#408080;font-style:italic">## Read the test data and perform the exact same as the example data</span>
<span style="color:#008000;font-weight:bold">with</span> <span style="color:#008000">open</span>(<span style="color:#ba2121">&#39;cgmnt_input22_test_data.txt&#39;</span>) <span style="color:#008000;font-weight:bold">as</span> infile:
    RAW_TEST_DATA <span style="color:#666">=</span> infile<span style="color:#666">.</span>readlines()
ARRAY_TEST_DATA <span style="color:#666">=</span> to_array(RAW_TEST_DATA)
TEST_PREDICTIONS <span style="color:#666">=</span> tf<span style="color:#666">.</span>argmax(model<span style="color:#666">.</span>predict(ARRAY_TEST_DATA), axis<span style="color:#666">=</span><span style="color:#666">1</span>)<span style="color:#666">.</span>numpy()<span style="color:#666">.</span>tolist()
draw_predictions(TEST_PREDICTIONS)
</code></pre></div><p>Data generation code below in J.</p>
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-j" data-lang="j"><span style="color:#408080;font-style:italic">NB. Make the training labels and write to file.</span>
<span style="color:#19177c">makeLabels</span> <span style="color:#666">=:</span> <span style="color:#666">]{~</span><span style="color:#666">240</span><span style="">?</span><span style="color:#666">@:##</span>
<span style="color:#19177c">Labels</span> <span style="color:#666">=:</span> <span style="color:#19177c">makeLabels</span> <span style="color:#ba2121">&#39;URDL&#39;</span>
<span style="color:#19177c">Labels</span> <span style="color:#19177c">fwrite</span> <span style="color:#666">&lt;</span> <span style="color:#ba2121">&#39;cgmnt_input22_training_labels.txt&#39;</span>

<span style="color:#408080;font-style:italic">NB. Generate ground truth values</span>
<span style="color:#19177c">gen</span> <span style="color:#666">=:</span> <span style="color:#666">[:</span> <span style="">?</span> <span style="color:#666">12</span> <span style="color:#666">1000</span> <span style="color:#666">$</span> <span style="color:#666">]</span>
<span style="color:#19177c">U</span> <span style="color:#666">=:</span> <span style="color:#19177c">gen</span> <span style="color:#666">2</span>
<span style="color:#19177c">R</span> <span style="color:#666">=:</span> <span style="color:#19177c">gen</span> <span style="color:#666">2</span>
<span style="color:#19177c">D</span> <span style="color:#666">=:</span> <span style="color:#19177c">gen</span> <span style="color:#666">2</span>
<span style="color:#19177c">L</span> <span style="color:#666">=:</span> <span style="color:#19177c">gen</span> <span style="color:#666">2</span>
<span style="color:#19177c">Truth</span> <span style="color:#666">=:</span> <span style="color:#19177c">U</span><span style="color:#666">;</span><span style="color:#19177c">R</span><span style="color:#666">;</span><span style="color:#19177c">D</span><span style="color:#666">;&lt;</span><span style="color:#19177c">L</span>

<span style="color:#408080;font-style:italic">NB. Create noisy training data</span>
<span style="color:#19177c">noisen</span> <span style="color:#666">=:</span> <span style="color:#666">2</span><span style="color:#666">|]+</span><span style="color:#666">0.</span><span style="color:#666">33</span><span style="color:#666">&gt;$</span><span style="">?</span><span style="color:#666">@:$</span><span style="color:#666">0</span><span style="color:#666">:</span>
<span style="color:#19177c">createData</span> <span style="color:#666">=:</span> <span style="color:#19177c">verb</span> <span style="color:#666">:</span><span style="color:#ba2121">&#39;|:;|: each noisen each Truth{~&#39;&#39;URDL&#39;&#39;i.y&#39;</span>
<span style="color:#19177c">writeData</span> <span style="color:#666">=:</span> <span style="color:#19177c">dyad</span> <span style="color:#666">:</span><span style="color:#ba2121">&#39;(_1}.;LF,~&#34;1;&#34;1 &#34;: each x) fwrite &lt; y&#39;</span>


<span style="color:#408080;font-style:italic">NB. Training data creation</span>
<span style="color:#19177c">TrainingData</span> <span style="color:#666">=:</span> <span style="color:#19177c">createData</span> <span style="color:#19177c">Labels</span>
<span style="color:#19177c">TrainingData</span> <span style="color:#19177c">writeData</span> <span style="color:#ba2121">&#39;cgmnt_input22_training_data.txt&#39;</span>

<span style="color:#408080;font-style:italic">NB. Answer data creation</span>
<span style="color:#19177c">Answer</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;LDRDLRRUUDDRUURLDDRULRDRUURDDRUURDLRDRUUDDRR&#39;</span>
<span style="color:#19177c">AnswerData</span> <span style="color:#666">=:</span> <span style="color:#19177c">createData</span> <span style="color:#19177c">Answer</span>
<span style="color:#19177c">AnswerData</span> <span style="color:#19177c">writeData</span> <span style="color:#ba2121">&#39;cgmnt_input22_test_data.txt&#39;</span>

<span style="color:#408080;font-style:italic">NB. Example data creation</span>
<span style="color:#19177c">Example</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;UUDRUDDRUURLDRLDRRUUDDRRUUDDRRUURDDL&#39;</span>
<span style="color:#19177c">ExampleData</span> <span style="color:#666">=:</span> <span style="color:#19177c">createData</span> <span style="color:#19177c">Example</span>
<span style="color:#19177c">ExampleData</span> <span style="color:#19177c">writeData</span> <span style="color:#ba2121">&#39;cgmnt_input22_example_data.txt&#39;</span>
</code></pre></div>
            </section>

        </article>
    </section>

    
    <footer>Contact us at <code> contact at cigmah dot org </code>.
</footer>
    

</section>


        </main>


    </body>
</html>
