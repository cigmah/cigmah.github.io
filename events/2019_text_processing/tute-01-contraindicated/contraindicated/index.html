
<!DOCTYPE html>
<html><head>
    
    
    <title> CIGMAH - Contraindicated </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="">
    <meta name="theme-color" content="#000000" />
    <link rel="icon" href="https://cigmah.org/favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cigmah.org/js/toggles.js"></script>
    <link type="text/css" rel="stylesheet" href=https://cigmah.org/sass/main.css>
    <link rel="canonical" href="https://cigmah.org/events/2019_text_processing/tute-01-contraindicated/contraindicated/">
</head>
<body>
        <header>

            <nav id="nav-menu-toggle" onClick="toggleNav()">
                <div id="menu-text">â˜°</div>
                <div id="cigmah-brand">
                    <div id="cigmah-icon">
                        <img src="https://cigmah.org/img/cigmah-icon.png">
                    </div>
                    <div id="cigmah-text">
                        CIGMAH
                    </div>
                </div>
            </nav>

            <nav id="nav-bar">

<ul id="nav-link-list" onClick="()">

    <li
        class="nav-link-list-item "
    >
        <a
            class="nav-link-list-link "
            id="nav-cigmah-link"
            href=https://cigmah.org/
        >
            <img id="nav-cigmah-link-icon" src="/img/cigmah-icon-small.png">
            <div>CIGMAH</div>
        </a>
    </li>

  
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/about/
        >
            About
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/events/
        >
            Events
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/tools/
        >
            Tools
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/resources/
        >
            Resources
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/blog/
        >
            Blog
        </a>
    </li>
    
    <li
        class="nav-link-list-item "
        >
        <a
            class="nav-link-list-link "
            href=https://cigmah.org/contact/
        >
            Contact
        </a>
    </li>
    

    <li
        class="nav-link-list-item"
        id="nav-right-item"
        >
        <a
            href="https://aorta.cigmah.org"
            id="nav-aorta-link"
            class="nav-link-list-link"
        >
            <img id="nav-aorta-link-icon" src="/img/aorta-icon.png">
            <div id="nav-aorta-link">AORTA</div>
        </a>
    </li>
</ul>
</nav>

        </header>

        <main>



<section class="normal-page">
    <article id="side-navigation">
        <article id="toggle-side-navigation-container">

            
            <a href="https://cigmah.org/events/2019_text_processing/tute-01-mapping-meningitis/mapping-meningitis/" id="back"> &lt;&lt; </a>
            

            <button id="toggle-side-navigation" onClick="toggleSideNav()">Show Articles</button>

            

        </article>

        <ul id="side-navigation-list">

            
            <li class="side-navigation-parent">
                <a href="https://cigmah.org/events/">Events</a>
            </li>
            


            <li class="side-navigation-section">
                <a href="https://cigmah.org/events/2019_text_processing/">
                    Night 1: Text Processing
                </a>
            </li>

            
            <li
                class="side-navigation-item  active "
            >
                <a href="https://cigmah.org/events/2019_text_processing/tute-01-contraindicated/contraindicated/">Contraindicated</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_text_processing/tute-01-mapping-meningitis/mapping-meningitis/">Mapping Meningitis</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_text_processing/tute-01-mood-diary/mood-diary/">Mood Diary</a>
            </li>
            
            <li
                class="side-navigation-item "
            >
                <a href="https://cigmah.org/events/2019_text_processing/tute-01-transfusion-tracing/transfusion-tracing/">Transfusion Tracing</a>
            </li>
            

        </ul>

    </article>

    <section id="container">

        <article id="content">
            <header id="content-header">
            <h1 id="content-title"> Contraindicated </h1>

            
                <div id="subtitle">
                    <div>  </div>
                </div>
            

            </div>

            </header>

            <section id="content-body">
                
<h2 id="headline-1">
Problem
</h2>
<p>
<a href="https://www1.health.gov.au/internet/main/publishing.nsf/Content/chronic-cardio">&#34;Cardiovascular disease is the leading cause of death and disease burden in
Australia&#34;</a>. One of the risk factors for cardiovascular disease is high blood
pressure (hypertension), which can be managed through non-pharmacological or
pharmacological approaches.
</p>
<p>
The Heart Foundation publishes a set of clinical guidelines relating to the
management of various cardiovascular conditions, including a <a href="https://www.heartfoundation.org.au/images/uploads/publications/PRO-167_Hypertension-guideline-2016_WEB.pdf">management
guideline for hypertension in adults</a>. This guideline outlines the important
clinical information for health professionals managing patients with high blood
pressure.
</p>
<p>
On Page 38 (Table 6.3), a number of compelling contraindications for four
classes of anti-hypertensive medications are listed. Here is an abridged version
of the table with <em>selected</em> &#34;compelling&#34; contraindications.
</p>
<table>
<thead>
<tr>
<th>Drug Class</th>
<th>Selected Compelling Contraindications</th>
</tr>
</thead>
<tbody>
<tr>
<td>ACE inhibitors or ARBs</td>
<td>Renal artery stenosis</td>
</tr>
<tr>
<td>Dihydropyridine calciucm channel blockers</td>
<td>N/A</td>
</tr>
<tr>
<td>Diuretics</td>
<td>Gout</td>
</tr>
<tr>
<td>Beta blockers (not first-line)</td>
<td>Asthma, Bradycardia or A-V block</td>
</tr>
</tbody>
</table>
<p>
As an audit of prescribing practices for hypertension, your clinical
supervisor has collated abridged and deidentified clinical records of 9999
patients. Here is the first record.
</p>
<div class="src src-text">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Patient ID: 0001
Antihypertensive: Carvedilol
PMHx:
  - Hyperthyroidism
  - Migraine
  - Recurrent UTIs</code></pre></div>
</div>
<p>
Each is in the same format, and each patient in this collection has only been
prescribed one-antihypertensive. The PMHx list for each patient varies in size;
some may be blank (though the word <code class="verbatim">PMHx:</code> will always appear). Any condition in
the PMHx appears exactly as listed in the above table (e.g. exactly as &#39;A-V
block&#39;), plus some other non-contraindicated conditions.
</p>
<p>
<strong>Your task</strong> is:
</p>
<ol>
<li>
<p>
Given a list of 9999 patients, determine the <strong>ONE</strong> patient who has been
prescribed an anti-hypertensive which is in contention with their PMHx; i.e,
determine the ID of the patient who has a compelling contraindication to the
antihypertensive they have been prescribed.
</p>
</li>
</ol>
<p>
You need only consider the selected compelling contraindications in the table we
have provided above.
</p>
<details><summary>Click to show the medications appearing in this dataset</summary>
<table>
<thead>
<tr>
<th>Drug Class</th>
<th>Medications</th>
</tr>
</thead>
<tbody>
<tr>
<td>ACE inhibitors/ ARBs</td>
<td>Captopril, Ramipril, Perindopril, Trandolapril, Candesartan</td>
</tr>
<tr>
<td>Beta blockers</td>
<td>Atenolol, Carvedilol, Metoprolol, Propranolol</td>
</tr>
<tr>
<td>Calcium channel blockers</td>
<td>Amlodipine, Nifedipine</td>
</tr>
<tr>
<td>Diuretics</td>
<td>Hydrochlorothiazide, Indapamide</td>
</tr>
</tbody>
</table>
</details>
<p>
<a href="../input-contraindicated.txt">Click here to download your text input. (1,803KB, .txt)</a>
</p>
<h2 id="headline-2">
Solution
</h2>
<details><summary>Click here to show the answer.</summary>
<p>
The ID of the single patient whose past medical history is in contention with
the contraindications of their antihypertensive is <strong>Patient ID 8047</strong>.
</p>
</details>
<details><summary>Click here to show the solution.</summary>
<blockquote>
<p>
We haven&#39;t explained this step-by-step in full yet, but here&#39;s the solution as
it stands at the moment. A more detailed explanation will appear shortly.
</p>
</blockquote>
<div class="src src-python">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#408080;font-style:italic"># Open and read the file input</span>
<span style="color:#008000;font-weight:bold">with</span> <span style="color:#008000">open</span>(<span style="color:#ba2121">&#39;./input-contraindicated.txt&#39;</span>) <span style="color:#008000;font-weight:bold">as</span> infile:
    RAW <span style="color:#666">=</span> infile<span style="color:#666">.</span>read()

<span style="color:#408080;font-style:italic"># Split each patient&#39;s record</span>
SEPARATOR <span style="color:#666">=</span> <span style="color:#ba2121">&#39;-&#39;</span> <span style="color:#666">*</span> <span style="color:#666">80</span>
SPLIT <span style="color:#666">=</span> [record<span style="color:#666">.</span>strip() <span style="color:#008000;font-weight:bold">for</span> record <span style="color:#a2f;font-weight:bold">in</span> RAW<span style="color:#666">.</span>split(SEPARATOR)]

<span style="color:#408080;font-style:italic"># Extract the data from each patient&#39;s record</span>
<span style="color:#008000;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">re</span>
MATCH_RE <span style="color:#666">=</span> <span style="color:#ba2121">r</span><span style="color:#ba2121">&#39;Patient ID: (\d+)\nAntihypertensive: (\w+)\nPMHx:(.*)&#39;</span>
MATCHER <span style="color:#666">=</span> re<span style="color:#666">.</span>compile(MATCH_RE, re<span style="color:#666">.</span>DOTALL)
SUBDIVIDED <span style="color:#666">=</span> [MATCHER<span style="color:#666">.</span>match(record) <span style="color:#008000;font-weight:bold">for</span> record <span style="color:#a2f;font-weight:bold">in</span> SPLIT]

<span style="color:#408080;font-style:italic"># Split and process each if required (split each history item)</span>
PATIENT_IDS <span style="color:#666">=</span> [match[<span style="color:#666">1</span>] <span style="color:#008000;font-weight:bold">for</span> match <span style="color:#a2f;font-weight:bold">in</span> SUBDIVIDED]
ANTI_HYPERTENSIVES <span style="color:#666">=</span> [match[<span style="color:#666">2</span>] <span style="color:#008000;font-weight:bold">for</span> match <span style="color:#a2f;font-weight:bold">in</span> SUBDIVIDED]
HISTORIES <span style="color:#666">=</span> [<span style="color:#008000">set</span>(re<span style="color:#666">.</span>findall(<span style="color:#ba2121">r</span><span style="color:#ba2121">&#39;- ([A-Za-z\- ]+)&#39;</span>, match[<span style="color:#666">3</span>])) <span style="color:#008000;font-weight:bold">for</span> match <span style="color:#a2f;font-weight:bold">in</span> SUBDIVIDED]

<span style="color:#408080;font-style:italic"># Rejoin the processed data</span>
DATA <span style="color:#666">=</span> <span style="color:#008000">list</span>(<span style="color:#008000">zip</span>(PATIENT_IDS, ANTI_HYPERTENSIVES, HISTORIES))

<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">typing</span> <span style="color:#008000;font-weight:bold">import</span> Dict, Set
<span style="color:#008000;font-weight:bold">from</span> <span style="color:#00f;font-weight:bold">enum</span> <span style="color:#008000;font-weight:bold">import</span> Enum

<span style="color:#408080;font-style:italic"># Define a drug cclass enumeration for convenience</span>
<span style="color:#008000;font-weight:bold">class</span> <span style="color:#00f;font-weight:bold">DrugClass</span>(Enum):
    A <span style="color:#666">=</span> <span style="color:#666">0</span>
    B <span style="color:#666">=</span> <span style="color:#666">1</span>
    C <span style="color:#666">=</span> <span style="color:#666">2</span>
    D <span style="color:#666">=</span> <span style="color:#666">3</span>

<span style="color:#408080;font-style:italic"># Raw drugs by class</span>
DRUG_AS <span style="color:#666">=</span> <span style="color:#ba2121">&#39; Captopril, Ramipril, Perindopril, Trandolapril, Candesartan &#39;</span>
DRUG_BS <span style="color:#666">=</span> <span style="color:#ba2121">&#39; Atenolol, Carvedilol, Metoprolol, Propranolol               &#39;</span>
DRUG_CS <span style="color:#666">=</span> <span style="color:#ba2121">&#39; Amlodipine, Nifedipine                                      &#39;</span>
DRUG_DS <span style="color:#666">=</span> <span style="color:#ba2121">&#39; Hydrochlorothiazide, Indapamide                             &#39;</span>

<span style="color:#408080;font-style:italic"># Define a function to convert raw into dictionary to class</span>
<span style="color:#008000;font-weight:bold">def</span> <span style="color:#00f">extract</span>(raw: <span style="color:#008000">str</span>, drug_class: DrugClass) <span style="color:#666">-&gt;</span> Dict[DrugClass, Set[<span style="color:#008000">str</span>]]:
    <span style="color:#ba2121">&#34;&#34;&#34; Extract drugs into a dictionary mapping all to class.
</span><span style="color:#ba2121">    &#34;&#34;&#34;</span>
    drug_list <span style="color:#666">=</span> [drug<span style="color:#666">.</span>strip() <span style="color:#008000;font-weight:bold">for</span> drug <span style="color:#a2f;font-weight:bold">in</span> raw<span style="color:#666">.</span>split(<span style="color:#ba2121">&#39;,&#39;</span>)]
    <span style="color:#008000;font-weight:bold">return</span> {drug: drug_class <span style="color:#008000;font-weight:bold">for</span> drug <span style="color:#a2f;font-weight:bold">in</span> drug_list}

<span style="color:#408080;font-style:italic"># Extract each and merge the dictionaries</span>
DRUG_TO_CLASS <span style="color:#666">=</span> {
    <span style="color:#666">**</span>extract(DRUG_AS, DrugClass<span style="color:#666">.</span>A),
    <span style="color:#666">**</span>extract(DRUG_BS, DrugClass<span style="color:#666">.</span>B),
    <span style="color:#666">**</span>extract(DRUG_CS, DrugClass<span style="color:#666">.</span>C),
    <span style="color:#666">**</span>extract(DRUG_DS, DrugClass<span style="color:#666">.</span>D),
}

<span style="color:#408080;font-style:italic"># Define dictionary mapping drug class to contraindications</span>
CONTRAINDICATIONS <span style="color:#666">=</span> {
    DrugClass<span style="color:#666">.</span>A: <span style="color:#008000">set</span>([<span style="color:#ba2121">&#39;Renal artery stenosis&#39;</span>]),
    DrugClass<span style="color:#666">.</span>B: <span style="color:#008000">set</span>([<span style="color:#ba2121">&#39;Asthma&#39;</span>, <span style="color:#ba2121">&#39;Bradycardia&#39;</span>, <span style="color:#ba2121">&#39;A-V block&#39;</span>]),
    DrugClass<span style="color:#666">.</span>C: <span style="color:#008000">set</span>(),
    DrugClass<span style="color:#666">.</span>D: <span style="color:#008000">set</span>(<span style="color:#ba2121">&#39;Gout&#39;</span>)
}

<span style="color:#408080;font-style:italic"># Filter the list by set intersection between PMHx and contraindications</span>
CONTENTION <span style="color:#666">=</span> [
    (patient, antihypertensive, pmhx)
    <span style="color:#008000;font-weight:bold">for</span> patient, antihypertensive, pmhx <span style="color:#a2f;font-weight:bold">in</span> DATA
    <span style="color:#008000;font-weight:bold">if</span> pmhx<span style="color:#666">.</span>intersection(CONTRAINDICATIONS[DRUG_TO_CLASS[antihypertensive]])
]

<span style="color:#008000;font-weight:bold">print</span>(CONTENTION)</code></pre></div>
</div>
<pre class="example">
[(&#39;8047&#39;, &#39;Propranolol&#39;, {&#39;Psoriasis&#39;, &#39;Asthma&#39;})]
</pre>
</details>
<details><summary>Click here to show another solution (in J).</summary>
<div class="src src-j">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-j" data-lang="j"><span style="color:#19177c">Data</span> <span style="color:#666">=:</span> <span style="color:#19177c">fread</span> <span style="color:#666">&lt;</span> <span style="color:#ba2121">&#39;input-contraindicated.txt&#39;</span>
<span style="color:#19177c">Records</span> <span style="color:#666">=:</span> (<span style="color:#666">80</span><span style="color:#666">#</span><span style="color:#ba2121">&#39;-&#39;</span>) <span style="color:#19177c">splitstring</span> <span style="color:#19177c">Data</span>

<span style="color:#19177c">Patients</span> <span style="color:#666">=:</span> (<span style="color:#19177c">CR</span> <span style="color:#19177c">taketo</span> <span style="color:#ba2121">&#39;Patient ID: &#39;</span> <span style="color:#19177c">takeafter</span> <span style="color:#666">]</span>) <span style="color:#19177c">each</span> <span style="color:#19177c">Records</span>
<span style="color:#19177c">Antihs</span> <span style="color:#666">=:</span> (<span style="color:#19177c">CR</span> <span style="color:#19177c">taketo</span> <span style="color:#ba2121">&#39;Antihypertensive: &#39;</span> <span style="color:#19177c">takeafter</span> <span style="color:#666">]</span>) <span style="color:#19177c">each</span> <span style="color:#19177c">Records</span>
<span style="color:#19177c">Histories</span> <span style="color:#666">=:</span> (<span style="color:#666">1</span><span style="color:#666">}.</span><span style="color:#19177c">CR</span> <span style="color:#19177c">taketo</span> <span style="color:#19177c">each</span> <span style="color:#ba2121">&#39;  - &#39;</span> <span style="color:#19177c">splitstring</span> <span style="color:#ba2121">&#39;PMHx:&#39;</span> <span style="color:#19177c">takeafter</span> <span style="color:#666">]</span>) <span style="color:#19177c">each</span> <span style="color:#19177c">Records</span>

<span style="color:#19177c">DrugAs</span> <span style="color:#666">=:</span> <span style="color:#19177c">dltb</span> <span style="color:#19177c">each</span> <span style="color:#ba2121">&#39;,&#39;</span> <span style="color:#19177c">splitstring</span> <span style="color:#ba2121">&#39;Captopril, Ramipril, Perindopril, Trandolapril, Candesartan &#39;</span>
<span style="color:#19177c">DrugBs</span> <span style="color:#666">=:</span> <span style="color:#19177c">dltb</span> <span style="color:#19177c">each</span> <span style="color:#ba2121">&#39;,&#39;</span> <span style="color:#19177c">splitstring</span> <span style="color:#ba2121">&#39;Atenolol, Carvedilol, Metoprolol, Propranolol               &#39;</span>
<span style="color:#19177c">DrugCs</span> <span style="color:#666">=:</span> <span style="color:#19177c">dltb</span> <span style="color:#19177c">each</span> <span style="color:#ba2121">&#39;,&#39;</span> <span style="color:#19177c">splitstring</span> <span style="color:#ba2121">&#39;Amlodipine, Nifedipine                                      &#39;</span>
<span style="color:#19177c">DrugDs</span> <span style="color:#666">=:</span> <span style="color:#19177c">dltb</span> <span style="color:#19177c">each</span> <span style="color:#ba2121">&#39;,&#39;</span> <span style="color:#19177c">splitstring</span> <span style="color:#ba2121">&#39;Hydrochlorothiazide, Indapamide                             &#39;</span>
<span style="color:#19177c">Drugs</span> <span style="color:#666">=:</span> <span style="color:#19177c">DrugAs</span><span style="color:#666">;</span><span style="color:#19177c">DrugBs</span><span style="color:#666">;</span><span style="color:#19177c">DrugCs</span><span style="color:#666">;&lt;</span><span style="color:#19177c">DrugDs</span>

<span style="color:#19177c">ContraAs</span> <span style="color:#666">=:</span> <span style="color:#666">&lt;</span><span style="color:#ba2121">&#39;Renal artery stenosis&#39;</span>
<span style="color:#19177c">ContraBs</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;Asthma&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Bradycardia&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;A-V block&#39;</span>
<span style="color:#19177c">ContraCs</span> <span style="color:#666">=:</span> <span style="color:#666">&lt;</span><span style="color:#666">0</span><span style="color:#666">$</span><span style="color:#666">0</span>
<span style="color:#19177c">ContraDs</span> <span style="color:#666">=:</span> <span style="color:#666">&lt;</span><span style="color:#ba2121">&#39;Gout&#39;</span>
<span style="color:#19177c">Contras</span> <span style="color:#666">=:</span> <span style="color:#19177c">ContraAs</span><span style="color:#666">;</span><span style="color:#19177c">ContraBs</span><span style="color:#666">;</span><span style="color:#19177c">ContraCs</span><span style="color:#666">;&lt;</span><span style="color:#19177c">ContraDs</span>

<span style="color:#19177c">PatientContras</span> <span style="color:#666">=:</span> (<span style="color:#666">[:&gt;</span><span style="color:#19177c">Contras</span> <span style="color:#666">{~</span> <span style="color:#666">1</span> <span style="color:#19177c">i</span><span style="color:#666">.~</span> <span style="color:#666">[:;</span> <span style="color:#19177c">Drugs</span> <span style="color:#19177c">e</span><span style="color:#666">.~</span> <span style="color:#19177c">each</span> <span style="color:#666">&lt;&amp;&lt;</span>) <span style="color:#19177c">each</span> <span style="color:#19177c">Antihs</span>
<span style="color:#19177c">Soln</span> <span style="color:#666">=:</span> <span style="color:#19177c">Patients</span> <span style="color:#666">{~</span> <span style="color:#666">1</span> <span style="color:#19177c">i</span><span style="color:#666">.~</span> <span style="color:#666">;</span><span style="color:#19177c">PatientContras</span> (<span style="color:#666">+/@:</span><span style="color:#19177c">e</span><span style="color:#666">.</span>) <span style="color:#19177c">each</span> <span style="color:#19177c">Histories</span></code></pre></div>
</div>
</details>
<h3 id="headline-3">
Data Generation
</h3>
<details><summary>Click here to show the data generation code.</summary>
<blockquote>
<p>
This data was generated with the <a href="https://www.jsoftware.com/#/">J programming language</a>. J is a descendent of
the <a href="https://en.wikipedia.org/wiki/APL_(programming_language)">APL programming language family</a>, infamous for being terse and apparently
unreadable. APL and J make very heavy use of symbols to expose useful primitive
operations on arrays - similar in many ways to Matlab or Python&#39;s Numpy. Though
the symbolism may look like obfuscation, it&#39;s not intentional. One of the core
ideas of the APL family is about operating on collections of data as a whole
rather than using conditional or looping structures, and the notation is simply
a way to express these operations compactly.
</p>
<p>
If you are interested in the APL/J/K family of languages, then we are always
very happy to have a chat to explain more about them. K (similar to J) is
apparently used quite heavily in the financial industry - so even though the
languages may appear unreadable, they <em>are</em> used in real-life.
</p>
</blockquote>
<p>
First, we initiate an array containing boxed items representing the drug names.
</p>
<div class="src src-j">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-j" data-lang="j"><span style="color:#19177c">DrugAs</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;Captopril&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Ramipril&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Perindopril&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Trandolapril&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Candesartan&#39;</span>
<span style="color:#19177c">DrugBs</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;Atenolol&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Carvedilol&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Metoprolol&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Propranolol&#39;</span>
<span style="color:#19177c">DrugCs</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;Amlodipine&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Nifedipine&#39;</span>
<span style="color:#19177c">DrugDs</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;Hydrochlorothiazide&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Indapamide&#39;</span>
<span style="color:#19177c">DrugsAll</span> <span style="color:#666">=:</span> <span style="color:#19177c">DrugAs</span><span style="color:#666">;</span><span style="color:#19177c">DrugBs</span><span style="color:#666">;</span><span style="color:#19177c">DrugCs</span><span style="color:#666">;&lt;</span><span style="color:#19177c">DrugDs</span></code></pre></div>
</div>
<p>
We then initiate an array containing the corresponding contraindications to each
drug class, and a general array containing a mixture of other non-listed conditions.
</p>
<div class="src src-j">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-j" data-lang="j"><span style="color:#19177c">CIAs</span> <span style="color:#666">=:</span> <span style="color:#666">&lt;</span><span style="color:#ba2121">&#39;Renal artery stenosis&#39;</span>
<span style="color:#19177c">CIBs</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;Asthma&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Bradycardia&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;A-V block&#39;</span>
<span style="color:#19177c">CIDs</span> <span style="color:#666">=:</span> <span style="color:#666">&lt;</span><span style="color:#ba2121">&#39;Gout&#39;</span>
<span style="color:#19177c">Conds</span> <span style="color:#666">=:</span> <span style="color:#ba2121">&#39;GORD&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Osteoarthritis&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Osteoporosis&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;SLE&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Migraine&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;HLD&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Generalised anxiety disorder&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Parkinson&#39;&#39;s disease&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Depression&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Obesity&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Rheumatoid arthritis&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Recurrent UTIs&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Hyperthyroidism&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Allergic rhinitis&#39;</span><span style="color:#666">;</span><span style="color:#ba2121">&#39;Psoriasis&#39;</span>
<span style="color:#19177c">CondsAll</span> <span style="color:#666">=:</span> <span style="color:#19177c">CIAs</span><span style="color:#666">;</span><span style="color:#19177c">CIBs</span><span style="color:#666">;</span>(<span style="color:#666">0</span><span style="color:#666">$</span><span style="color:#666">0</span>)<span style="color:#666">;</span><span style="color:#19177c">CIDs</span><span style="color:#666">;&lt;</span><span style="color:#19177c">Conds</span></code></pre></div>
</div>
<p>
Next, we define some pure functions that will select and randomly choose from
these lists.
</p>
<div class="src src-j">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-j" data-lang="j"><span style="color:#19177c">iselect</span> <span style="color:#666">=:</span> <span style="color:#666">[:</span> <span style="color:#666">&gt;@</span>(<span style="color:#666">]</span> <span style="color:#666">{~</span> ?<span style="color:#666">@#</span>) <span style="color:#666">]</span> <span style="color:#666">&gt;@:{</span> <span style="color:#666">[</span>                           <span style="color:#408080;font-style:italic">NB. random select from x at index y</span>
<span style="color:#19177c">censor</span>  <span style="color:#666">=:</span> <span style="color:#19177c">dyad</span> <span style="color:#666">:</span><span style="color:#ba2121">&#39;;(&lt;0$0) (y}) x&#39;</span>                             <span style="color:#408080;font-style:italic">NB. remove from x at index y</span>
<span style="color:#19177c">choose</span>  <span style="color:#666">=:</span> <span style="color:#666">]{~</span><span style="">?</span><span style="color:#666">@</span>(<span style="color:#666">[:&lt;.</span><span style="color:#666">3</span><span style="color:#666">%~#</span>)<span style="">?</span><span style="color:#666">#</span>                                  <span style="color:#408080;font-style:italic">NB. randomly choose item</span>
<span style="color:#19177c">makesafe</span> <span style="color:#666">=:</span> <span style="color:#666">&lt;@</span>(<span style="color:#19177c">DrugsAll</span><span style="color:#666">&amp;</span><span style="color:#19177c">iselect</span>) <span style="color:#666">;</span> <span style="color:#666">&lt;@</span><span style="color:#19177c">choose</span><span style="color:#666">@</span>(<span style="color:#19177c">CondsAll</span><span style="color:#666">&amp;</span><span style="color:#19177c">censor</span>)
<span style="color:#19177c">makeunsafe</span> <span style="color:#666">=:</span> <span style="color:#666">&lt;@</span>(<span style="color:#19177c">DrugsAll</span><span style="color:#666">&amp;</span><span style="color:#19177c">iselect</span>)<span style="color:#666">;</span>(<span style="color:#666">[:&lt;@</span>((<span style="color:#666">#</span>?<span style="color:#666">#</span>)<span style="color:#666">{]</span>)((?<span style="color:#666">@#{]</span>)<span style="color:#19177c">CIBs</span>)<span style="color:#666">,</span><span style="color:#19177c">choose</span><span style="color:#666">@</span>(<span style="color:#19177c">CondsAll</span><span style="color:#666">&amp;</span><span style="color:#19177c">censor</span>))</code></pre></div>
</div>
<p>
We then create the list of patients - 9998 patients without a contraindication
to their corresponding antihypertensive, and one with a contraindication.
</p>
<div class="src src-j">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-j" data-lang="j"><span style="color:#19177c">Safe</span> <span style="color:#666">=:</span> <span style="color:#19177c">makesafe</span> <span style="color:#19177c">each</span> <span style="">?</span> <span style="color:#666">9998</span> <span style="color:#666">#</span> <span style="color:#666">4</span>
<span style="color:#19177c">Unsafe</span> <span style="color:#666">=:</span> <span style="color:#666">&lt;</span> <span style="color:#19177c">makeunsafe</span> <span style="color:#666">1</span>
<span style="color:#19177c">All</span> <span style="color:#666">=:</span> ((<span style="color:#666">#</span>?<span style="color:#666">#</span>)<span style="color:#666">{]</span>) <span style="color:#19177c">Safe</span> <span style="color:#666">,</span> <span style="color:#19177c">Unsafe</span></code></pre></div>
</div>
<p>
We then define how each patient&#39;s generated data should be formatted by defining
some pure formatting functions.
</p>
<div class="src src-j">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-j" data-lang="j"><span style="color:#19177c">fmtfirst</span> <span style="color:#666">=:</span> <span style="color:#19177c">LF</span><span style="color:#666">,~</span><span style="color:#ba2121">&#39;Antihypertensive: &#39;</span><span style="color:#666">,&gt;@&gt;@</span>(<span style="color:#666">0</span><span style="color:#666">&amp;{</span>)                <span style="color:#408080;font-style:italic">NB. format antihypertensive</span>
<span style="color:#19177c">fmtsecond</span> <span style="color:#666">=:</span> (<span style="color:#ba2121">&#39;PMHx:&#39;</span><span style="color:#666">,</span><span style="color:#19177c">LF</span>)<span style="color:#666">,[:;[:</span>(<span style="color:#ba2121">&#39;  - &#39;</span><span style="color:#666">,</span><span style="color:#19177c">LF</span><span style="color:#666">,~]</span>)<span style="color:#666">&amp;.&gt;&gt;@</span>(<span style="color:#666">1</span><span style="color:#666">&amp;{</span>)       <span style="color:#408080;font-style:italic">NB. format medication list</span>
<span style="color:#19177c">pad</span> <span style="color:#666">=:</span> <span style="color:#666">[:;=&amp;</span><span style="color:#ba2121">&#39; &#39;</span><span style="color:#666">{</span><span style="color:#19177c">each</span><span style="color:#666">,&amp;</span><span style="color:#ba2121">&#39;0&#39;</span><span style="color:#19177c">each</span>
<span style="color:#19177c">fmtid</span> <span style="color:#666">=:</span> <span style="color:#19177c">LF</span><span style="color:#666">,~</span><span style="color:#ba2121">&#39;Patient ID: &#39;</span><span style="color:#666">,</span><span style="color:#19177c">pad</span><span style="color:#666">@</span>(<span style="color:#666">4</span><span style="color:#666">&amp;&#34;:</span>)
<span style="color:#19177c">fmt</span> <span style="color:#666">=:</span> <span style="color:#19177c">fmtid</span><span style="color:#666">@[,</span><span style="color:#19177c">fmtfirst</span><span style="color:#666">@],</span><span style="color:#19177c">fmtsecond</span><span style="color:#666">@]</span></code></pre></div>
</div>
<p>
Finally, we format the data we&#39;ve generated and write it to a file.
</p>
<div class="src src-j">
<div class="highlight"><pre style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-j" data-lang="j"><span style="color:#19177c">Data</span> <span style="color:#666">=:</span> <span style="color:#666">;</span>(<span style="color:#666">&lt;</span><span style="color:#19177c">LF</span><span style="color:#666">,</span><span style="color:#19177c">LF</span><span style="color:#666">,~</span><span style="color:#19177c">LF</span><span style="color:#666">,~</span><span style="color:#666">80</span><span style="color:#666">#</span><span style="color:#ba2121">&#39;-&#39;</span>)<span style="color:#666">,</span><span style="color:#19177c">each</span>((<span style="color:#666">1</span><span style="color:#666">+</span><span style="color:#19177c">i</span><span style="color:#666">.@#</span>) <span style="color:#19177c">fmt</span> <span style="color:#19177c">each</span> <span style="color:#666">]</span>) <span style="color:#19177c">All</span>
<span style="color:#19177c">Data</span> <span style="color:#19177c">fwrite</span> <span style="color:#ba2121">&#39;input-contraindicated.txt&#39;</span></code></pre></div>
</div>
</details>

            </section>

        </article>
    </section>

</section>


        </main>

        
        <footer>Contact us at <code> contact at cigmah dot org </code>.
</footer>
        

    </body>
</html>
